<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>graphics: graphics/PropertyEditor.py Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Packages</span></a></li>
    <li><a href="classes.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir_dc27557eb50c9a5c2577a405955536a2.html">graphics</a></div>
<h1>PropertyEditor.py</h1><a href="PropertyEditor_8py.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a><a class="code" href="namespacegraphics_1_1PropertyEditor.html">00001</a> <span class="keyword">import</span>  wx
<a name="l00002"></a>00002 <span class="keyword">import</span>  wx.grid <span class="keyword">as</span> gridlib
<a name="l00003"></a>00003 <span class="keyword">from</span> graphics.PropertyEditorTable <span class="keyword">import</span> PropertyEditorTable
<a name="l00004"></a>00004 <span class="keyword">from</span> graphics.PlotBrowser <span class="keyword">import</span> PlotBrowser
<a name="l00005"></a>00005 <span class="keyword">from</span> pylab <span class="keyword">import</span> setp, getp
<a name="l00006"></a>00006 <span class="keyword">from</span> numpy <span class="keyword">import</span> array     
<a name="l00007"></a>00007 
<a name="l00008"></a>00008 __doc__=<span class="stringliteral">'''Expected behavior is that upon loading a certain data type a property editor panel will also be created</span>
<a name="l00009"></a>00009 <span class="stringliteral">containing a copy of the types of properties and getting the initial values from that new data structure (usually the </span>
<a name="l00010"></a>00010 <span class="stringliteral">defaults).'''</span>
<a name="l00011"></a>00011 
<a name="l00012"></a>00012 <span class="keyword">class </span>PropertyEditor(gridlib.Grid):
<a name="l00013"></a>00013     
<a name="l00014"></a>00014    <span class="comment"># currentItem = PlotBrowser.currentItem</span>
<a name="l00015"></a>00015     
<a name="l00016"></a>00016     <span class="keyword">def </span><a class="code" href="namespacegraphics_1_1VtkWrap.html#b13b85ff786bc5f610f9c25fffe85b1f">__init__</a>(self, parent):
<a name="l00017"></a>00017         gridlib.Grid.__init__(self, parent, -1, size=(252,546))
<a name="l00018"></a><a class="code" href="namespacegraphics_1_1PropertyEditor.html#ed785f94d330503f567d17a5f396b21c">00018</a>         self.parent=parent
<a name="l00019"></a><a class="code" href="namespacegraphics_1_1PropertyEditor.html#08f63fc402c92922c267b2eb0f03ad63">00019</a>         <span class="comment">#self.selectedItem = parent.plotBrowserController.selectedItem</span>
<a name="l00020"></a><a class="code" href="namespacegraphics_1_1PropertyEditor.html#bb4a2d623e874979af3b9e2b20d81507">00020</a>         self.backendWrap = self.parent.backendWrap
<a name="l00021"></a><a class="code" href="namespacegraphics_1_1PropertyEditor.html#abc68a5be4dfc320f36041dd10edce58">00021</a>         self.plotItems = self.parent.plotItems<span class="comment">#mplibCon.matplotlib.plotItems</span>
<a name="l00022"></a><a class="code" href="namespacegraphics_1_1PropertyEditor.html#9007f31217b265b2323e54c3e435cdbb">00022</a>         self.backend = self.parent.backend
<a name="l00023"></a>00023         
<a name="l00024"></a><a class="code" href="namespacegraphics_1_1PropertyEditor.html#075a057aa8dcd57bce61589c04f9e714">00024</a>         self.table = PropertyEditorTable(self)
<a name="l00025"></a>00025         self.SetTable(self.table)
<a name="l00026"></a>00026         self.setGridConditions()
<a name="l00027"></a>00027         gridlib.EVT_GRID_CELL_LEFT_DCLICK(self, self.OnLeftDClick)
<a name="l00028"></a>00028         gridlib.EVT_GRID_CELL_CHANGE(self, self.OnCellChange)
<a name="l00029"></a>00029         <span class="comment">#self.Bind(gridlib.EVT_GRID_CELL_CHANGE, self.OnCellChange)</span>
<a name="l00030"></a>00030         
<a name="l00031"></a>00031     <span class="keyword">def </span>setGridConditions(self):
<a name="l00032"></a>00032         self.SetRowLabelSize(0)
<a name="l00033"></a>00033         self.SetColLabelSize(0)
<a name="l00034"></a>00034         self.SetMargins(0,0)
<a name="l00035"></a>00035         self.AutoSizeColumns(<span class="keyword">True</span>)
<a name="l00036"></a>00036         self.setMaxColWidth(200)
<a name="l00037"></a>00037         self.SetDefaultCellAlignment(wx.ALIGN_LEFT, wx.ALIGN_CENTRE)
<a name="l00038"></a>00038         <span class="comment">#self.SetColAttr(1,)</span>
<a name="l00039"></a>00039 
<a name="l00040"></a>00040         <span class="comment">#do something like set maximum column width</span>
<a name="l00041"></a>00041         
<a name="l00042"></a>00042     <span class="keyword">def </span>setMaxColWidth(self,maxWidth):
<a name="l00043"></a>00043         <span class="comment">#numCols=self.table.GetNumberCols()</span>
<a name="l00044"></a>00044         <span class="comment"># resize the columns smaller if twoo big</span>
<a name="l00045"></a>00045                 <span class="comment"># resize the columns smaller if twoo big</span>
<a name="l00046"></a>00046         col1Size=self.GetColSize(0)
<a name="l00047"></a>00047         <span class="keywordflow">if</span> col1Size&gt;maxWidth:
<a name="l00048"></a>00048             self.SetColSize(0,maxWidth)
<a name="l00049"></a>00049         col2Size=self.GetColSize(1)
<a name="l00050"></a>00050         <span class="keywordflow">if</span> col2Size&gt;maxWidth:
<a name="l00051"></a>00051             self.SetColSize(1,maxWidth)
<a name="l00052"></a>00052         
<a name="l00053"></a>00053         
<a name="l00054"></a>00054     <span class="comment"># I do this because I don't like the default behaviour of not starting the</span>
<a name="l00055"></a>00055     <span class="comment"># cell editor on double clicks, but only a second click.</span>
<a name="l00056"></a>00056     <span class="keyword">def </span>OnLeftDClick(self, evt):
<a name="l00057"></a>00057         <span class="keywordflow">if</span> evt.GetCol()==1:
<a name="l00058"></a>00058             self.EnableCellEditControl()
<a name="l00059"></a>00059             
<a name="l00060"></a>00060     <span class="keyword">def </span>OnCellChange(self, evt):
<a name="l00061"></a>00061         row=evt.GetRow()
<a name="l00062"></a>00062         value = self.GetCellValue(row, evt.GetCol())
<a name="l00063"></a>00063         <span class="comment">#exec(apiMethod+'('+str(value)+')')</span>
<a name="l00064"></a>00064         <span class="keywordflow">if</span> self.backend==<span class="stringliteral">'matplotlib'</span>:
<a name="l00065"></a>00065             <span class="keywordflow">if</span> PlotBrowser.currentItem!=<span class="stringliteral">'plottable'</span>:
<a name="l00066"></a>00066                 self.matplotlibChange(row, value)
<a name="l00067"></a>00067             <span class="keywordflow">elif</span> PlotBrowser.currentItem==<span class="stringliteral">'plottable'</span>:
<a name="l00068"></a>00068                 self.plottableChange(value)
<a name="l00069"></a>00069             self.matplotlibWrap.replot()
<a name="l00070"></a>00070         <span class="keywordflow">elif</span> self.backend==<span class="stringliteral">'vtk'</span>:
<a name="l00071"></a>00071             self.vtkChange(row, value)
<a name="l00072"></a>00072         
<a name="l00073"></a>00073     <span class="keyword">def </span>matplotlibChange(self, row, value):
<a name="l00074"></a>00074         apiKeyword = self.table.properties[row][3]
<a name="l00075"></a>00075         objectReference = self.plotItems[PlotBrowser.currentItem]
<a name="l00076"></a>00076         <span class="comment">#first take care of some special cases:</span>
<a name="l00077"></a>00077         <span class="comment">#from decimal import Decimal</span>
<a name="l00078"></a>00078         <span class="comment">#getcontext().prec = 2</span>
<a name="l00079"></a>00079         sequence2String=[<span class="stringliteral">'xlim'</span>,<span class="stringliteral">'ylim'</span>]
<a name="l00080"></a>00080         array2String=[<span class="stringliteral">'xticks'</span>,<span class="stringliteral">'yticks'</span>,<span class="stringliteral">'xdata'</span>,<span class="stringliteral">'ydata'</span>]
<a name="l00081"></a>00081         textBox2String=[<span class="stringliteral">'xticklabels'</span>,<span class="stringliteral">'yticklabels'</span>]
<a name="l00082"></a>00082         <span class="keywordflow">if</span> apiKeyword <span class="keywordflow">in</span> sequence2String:
<a name="l00083"></a>00083             value=eval(value)
<a name="l00084"></a>00084         <span class="keywordflow">elif</span> apiKeyword <span class="keywordflow">in</span> array2String:
<a name="l00085"></a>00085             value=eval(value)
<a name="l00086"></a>00086             value=array(value)
<a name="l00087"></a>00087         <span class="keywordflow">elif</span> apiKeyword <span class="keywordflow">in</span> textBox2String:
<a name="l00088"></a>00088             <span class="comment">#first get the Text instances</span>
<a name="l00089"></a>00089             listOfTexts=getp(objectReference, apiKeyword, value)
<a name="l00090"></a>00090             <span class="comment">#then set them</span>
<a name="l00091"></a>00091             strings=eval(value)
<a name="l00092"></a>00092             <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(listOfTexts)):
<a name="l00093"></a>00093                 listOfTexts[i].set_text(strings[i])
<a name="l00094"></a>00094             value=listOfTexts
<a name="l00095"></a>00095         <span class="comment">#set the new property    </span>
<a name="l00096"></a>00096         setp(objectReference, apiKeyword, value)
<a name="l00097"></a>00097         <span class="comment">#refresh all properties</span>
<a name="l00098"></a>00098         self.table.loadModel(PlotBrowser.currentItem)
<a name="l00099"></a>00099         
<a name="l00100"></a>00100     <span class="keyword">def </span>vtkChange(self, row, value):
<a name="l00101"></a>00101         apiKeyword = self.table.properties[row][0]
<a name="l00102"></a>00102         objectReference = self.plotItems[PlotBrowser.currentItem]
<a name="l00103"></a>00103         
<a name="l00104"></a>00104         <span class="comment">#first take care of some special cases:</span>
<a name="l00105"></a>00105         <span class="comment">#from decimal import Decimal</span>
<a name="l00106"></a>00106         <span class="comment">#getcontext().prec = 2</span>
<a name="l00107"></a>00107 <span class="comment">#        sequence2String=['xlim','ylim']</span>
<a name="l00108"></a>00108 <span class="comment">#        array2String=['xticks','yticks','xdata','ydata']</span>
<a name="l00109"></a>00109 <span class="comment">#        textBox2String=['xticklabels','yticklabels']</span>
<a name="l00110"></a>00110 <span class="comment">#        if apiKeyword in sequence2String:</span>
<a name="l00111"></a>00111 <span class="comment">#            value=eval(value)</span>
<a name="l00112"></a>00112 <span class="comment">#        elif apiKeyword in array2String:</span>
<a name="l00113"></a>00113 <span class="comment">#            value=eval(value)</span>
<a name="l00114"></a>00114 <span class="comment">#            value=array(value)</span>
<a name="l00115"></a>00115 <span class="comment">#        elif apiKeyword in textBox2String:</span>
<a name="l00116"></a>00116 <span class="comment">#            #first get the Text instances</span>
<a name="l00117"></a>00117 <span class="comment">#            listOfTexts=getp(objectReference, apiKeyword, value)</span>
<a name="l00118"></a>00118 <span class="comment">#            #then set them</span>
<a name="l00119"></a>00119 <span class="comment">#            strings=eval(value)</span>
<a name="l00120"></a>00120 <span class="comment">#            for i in range(len(listOfTexts)):</span>
<a name="l00121"></a>00121 <span class="comment">#                listOfTexts[i].set_text(strings[i])</span>
<a name="l00122"></a>00122 <span class="comment">#            value=listOfTexts</span>
<a name="l00123"></a>00123             
<a name="l00124"></a>00124         <span class="comment">#set the new property    </span>
<a name="l00125"></a>00125         objectReference.set(apiKeyword=value)
<a name="l00126"></a>00126         <span class="comment">#refresh all properties</span>
<a name="l00127"></a>00127         self.table.loadModel(PlotBrowser.currentItem)
<a name="l00128"></a>00128         
<a name="l00129"></a>00129     <span class="keyword">def </span>plottableChange(self, value):
<a name="l00130"></a>00130         <span class="comment">#mp.graph.set(eval(apiKeyword+"='"+value+"'"))</span>
<a name="l00131"></a>00131         keys = self.mplibCon.graph.plottables.keys()
<a name="l00132"></a>00132         self.mplibCon.graph.plottables[keys[0]] = int(value)
<a name="l00133"></a>00133         
<a name="l00134"></a>00134     <span class="keyword">def </span>changeModel(self,type):
<a name="l00135"></a>00135         self.table.loadModel(type)
<a name="l00136"></a>00136         self.ForceRefresh()    
<a name="l00137"></a>00137 <span class="comment">#        self.parent.Refresh()</span>
<a name="l00138"></a>00138         self.SetTable(self.table)
<a name="l00139"></a>00139         self.setGridConditions()
<a name="l00140"></a>00140             
<a name="l00141"></a>00141 <span class="comment">#---------------------------------------------------------------------------</span>
<a name="l00142"></a>00142 
<a name="l00143"></a>00143 <span class="keyword">class </span>TestFrame(wx.Frame):
<a name="l00144"></a>00144     <span class="keyword">def </span><a class="code" href="namespacegraphics_1_1VtkWrap.html#b13b85ff786bc5f610f9c25fffe85b1f">__init__</a>(self, parent, log):
<a name="l00145"></a>00145         wx.Frame.__init__(self, parent, -1, <span class="stringliteral">""</span>, size=(640,480))
<a name="l00146"></a>00146         p = wx.Panel(self, -1, style=0)
<a name="l00147"></a>00147         grid = PropertyEditor(p, log)
<a name="l00148"></a>00148         bs = wx.BoxSizer(wx.VERTICAL)
<a name="l00149"></a>00149         bs.Add(grid, 1, wx.GROW|wx.ALL, 5)
<a name="l00150"></a>00150         p.SetSizer(bs)
<a name="l00151"></a>00151 
<a name="l00152"></a>00152 <span class="keywordflow">if</span> __name__ == <span class="stringliteral">'__main__'</span>:
<a name="l00153"></a>00153     <span class="keyword">import</span> sys
<a name="l00154"></a>00154     app = wx.PySimpleApp()
<a name="l00155"></a>00155     frame = TestFrame(<span class="keywordtype">None</span>, sys.stdout)
<a name="l00156"></a>00156     frame.Show(<span class="keyword">True</span>)
<a name="l00157"></a>00157     app.MainLoop()
<a name="l00158"></a>00158 
<a name="l00159"></a>00159 
<a name="l00160"></a>00160             
<a name="l00161"></a>00161 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Fri Sep 28 18:29:16 2007 for graphics by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>
