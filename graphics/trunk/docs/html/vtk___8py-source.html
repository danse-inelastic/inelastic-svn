<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>graphics: graphics/vtk_.py Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Packages</span></a></li>
    <li><a href="classes.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir_dc27557eb50c9a5c2577a405955536a2.html">graphics</a></div>
<h1>vtk_.py</h1><a href="vtk___8py.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a><a class="code" href="namespacegraphics_1_1vtk__.html">00001</a> <span class="keyword">from</span> graphics.common <span class="keyword">import</span> *
<a name="l00002"></a>00002 <span class="keyword">import</span> vtk, os
<a name="l00003"></a>00003 
<a name="l00004"></a>00004 <span class="keyword">from</span> graphics.numpytools <span class="keyword">import</span> ravel, zeros, array, allclose, Float
<a name="l00005"></a>00005 
<a name="l00006"></a>00006 <span class="comment">#import vtk.util.colors</span>
<a name="l00007"></a>00007 
<a name="l00008"></a>00008 
<a name="l00009"></a>00009 <span class="keyword">import</span> wx
<a name="l00010"></a>00010 <span class="keyword">from</span> vtk.wx.wxVTKRenderWindow <span class="keyword">import</span> wxVTKRenderWindow
<a name="l00011"></a>00011 <span class="keyword">import</span> wxPython.wx
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 <span class="keyword">import</span> Tkinter
<a name="l00014"></a>00014 <span class="keyword">from</span> vtk.tk.vtkTkRenderWidget <span class="keyword">import</span> vtkTkRenderWidget
<a name="l00015"></a>00015 <span class="keyword">from</span> vtk.tk <span class="keyword">import</span> vtkTkRenderWidget
<a name="l00016"></a>00016 
<a name="l00017"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html">00017</a> <span class="keyword">class </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html">VtkBackend</a>(BaseClass):
<a name="l00018"></a>00018     <span class="stringliteral">"""Backend using VTK"""</span>
<a name="l00019"></a>00019 
<a name="l00020"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#f5075b63076a7eddae7fbe06d7373c8c">00020</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#f5075b63076a7eddae7fbe06d7373c8c">__init__</a>(self, parent=None):
<a name="l00021"></a>00021         BaseClass.__init__(self)
<a name="l00022"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#e2b54d7b779739e0c0ca74eb86e5101c">00022</a>         self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#e2b54d7b779739e0c0ca74eb86e5101c">parent</a>parent = parent
<a name="l00023"></a>00023         self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#7d7871308f41486a2dd0cb376e69cdd5">init</a>init()
<a name="l00024"></a>00024         
<a name="l00025"></a>00025 
<a name="l00026"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#7d7871308f41486a2dd0cb376e69cdd5">00026</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#7d7871308f41486a2dd0cb376e69cdd5">init</a>(self):
<a name="l00027"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#9b71d9b5ef9272afa3b48961093e121d">00027</a>         self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#9b71d9b5ef9272afa3b48961093e121d">_master</a>_master = <span class="keywordtype">None</span>
<a name="l00028"></a>00028         self.figure(self._attrs[<span class="stringliteral">'curfig'</span>])
<a name="l00029"></a>00029 
<a name="l00030"></a>00030         <span class="comment"># convert tables for formatstrings</span>
<a name="l00031"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#aa21ce1c55d4f085fa7333368c0dabfd">00031</a>         self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#aa21ce1c55d4f085fa7333368c0dabfd">_colors</a>_colors = {
<a name="l00032"></a>00032             <span class="stringliteral">''</span>:  (0,0,1), <span class="comment"># No color--&gt;Blue</span>
<a name="l00033"></a>00033             <span class="stringliteral">'k'</span>: (0,0,0), <span class="comment"># Black</span>
<a name="l00034"></a>00034             <span class="stringliteral">'</span><span class="stringliteral">r': (1,0,0), # Red </span>
<a name="l00035"></a>00035 <span class="stringliteral">            </span><span class="stringliteral">'g'</span>: (0,1,0), <span class="comment"># Green</span>
<a name="l00036"></a>00036             <span class="stringliteral">'b'</span>: (0,0,1), <span class="comment"># Blue</span>
<a name="l00037"></a>00037             <span class="stringliteral">'m'</span>: (1,0,1), <span class="comment"># Magenta</span>
<a name="l00038"></a>00038             <span class="stringliteral">'c'</span>: (0,1,1), <span class="comment"># Cyan</span>
<a name="l00039"></a>00039             <span class="stringliteral">'w'</span>: (1,1,1), <span class="comment"># White</span>
<a name="l00040"></a>00040             <span class="stringliteral">'y'</span>: (1,1,0), <span class="comment"># Yellow</span>
<a name="l00041"></a>00041             }
<a name="l00042"></a>00042 
<a name="l00043"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#8d9898b1f1e68ce60c45b89f6ac83322">00043</a>         self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#8d9898b1f1e68ce60c45b89f6ac83322">_arrow_types</a>_arrow_types = { <span class="comment"># tuple: (type,rotation)</span>
<a name="l00044"></a>00044             <span class="stringliteral">''</span>:  (9,0),  <span class="comment"># arrow</span>
<a name="l00045"></a>00045             <span class="stringliteral">'.'</span>: (0,0),  <span class="comment"># no marker</span>
<a name="l00046"></a>00046             <span class="stringliteral">'o'</span>: (7,0),  <span class="comment"># circle</span>
<a name="l00047"></a>00047             <span class="stringliteral">'+'</span>: (3,0),  <span class="comment"># plus</span>
<a name="l00048"></a>00048             <span class="stringliteral">'x'</span>: (3,45), <span class="comment"># x-mark</span>
<a name="l00049"></a>00049             <span class="stringliteral">'*'</span>: (3,0),  <span class="comment"># star --&gt; plus</span>
<a name="l00050"></a>00050             <span class="stringliteral">'s'</span>: (6,0),  <span class="comment"># square</span>
<a name="l00051"></a>00051             <span class="stringliteral">'d'</span>: (8,0),  <span class="comment"># diamond</span>
<a name="l00052"></a>00052             <span class="stringliteral">'v'</span>: (5,180),<span class="comment"># triangle (down) </span>
<a name="l00053"></a>00053             <span class="stringliteral">'^'</span>: (5,0),  <span class="comment"># triangle (up)</span>
<a name="l00054"></a>00054             <span class="stringliteral">'&lt;'</span>: (5,90), <span class="comment"># triangle (left) </span>
<a name="l00055"></a>00055             <span class="stringliteral">'&gt;'</span>: (5,270),<span class="comment"># triangle (right)</span>
<a name="l00056"></a>00056             <span class="stringliteral">'p'</span>: (6,0),  <span class="comment"># pentagram --&gt; square</span>
<a name="l00057"></a>00057             <span class="stringliteral">'h'</span>: (6,0),  <span class="comment"># hexagram --&gt; square</span>
<a name="l00058"></a>00058             }
<a name="l00059"></a>00059 
<a name="l00060"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#d04cef15148842eecfb491aea9143087">00060</a>         self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#d04cef15148842eecfb491aea9143087">_colorbar_locations</a>_colorbar_locations = {
<a name="l00061"></a>00061             <span class="stringliteral">'North'</span>: ((.2, .75), (.6,.09)),
<a name="l00062"></a>00062             <span class="stringliteral">'South'</span>: ((.2, .2), (.6, .09)),
<a name="l00063"></a>00063             <span class="stringliteral">'East'</span>: ((.75, .09), (.1, .9)),
<a name="l00064"></a>00064             <span class="stringliteral">'West'</span>: ((.2, .09), (.1, .9)),
<a name="l00065"></a>00065             <span class="stringliteral">'NorthOutside'</span>: ((.2, .86), (.6,.09)),
<a name="l00066"></a>00066             <span class="stringliteral">'SouthOutside'</span>: ((.2, .06), (.6, .09)),
<a name="l00067"></a>00067             <span class="stringliteral">'EastOutside'</span>: ((.86, .09), (.1, .9)),
<a name="l00068"></a>00068             <span class="stringliteral">'WestOutside'</span>: ((.01, .09), (.1, .9))
<a name="l00069"></a>00069             }
<a name="l00070"></a>00070 
<a name="l00071"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#c9e88f7337fd1002f527b17498b34c1c">00071</a>         self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#c9e88f7337fd1002f527b17498b34c1c">_image_writers</a>_image_writers = {
<a name="l00072"></a>00072             <span class="stringliteral">'tif'</span>: vtk.vtkTIFFWriter(),
<a name="l00073"></a>00073             <span class="stringliteral">'bmp'</span>: vtk.vtkBMPWriter(),
<a name="l00074"></a>00074             <span class="stringliteral">'pnm'</span>: vtk.vtkPNMWriter(),
<a name="l00075"></a>00075             <span class="stringliteral">'ps'</span>: vtk.vtkPostScriptWriter(),
<a name="l00076"></a>00076             <span class="stringliteral">'eps'</span>: vtk.vtkPostScriptWriter(),
<a name="l00077"></a>00077             <span class="stringliteral">'png'</span>: vtk.vtkPNGWriter(),
<a name="l00078"></a>00078             <span class="stringliteral">'jpg'</span>: vtk.vtkJPEGWriter(),
<a name="l00079"></a>00079             }
<a name="l00080"></a>00080         
<a name="l00081"></a>00081         <span class="keywordflow">try</span>:
<a name="l00082"></a>00082             v = vtk.vtkMesaRenderer()
<a name="l00083"></a>00083             _graphics_fact = vtk.vtkGraphicsFactory()
<a name="l00084"></a>00084             _graphics_fact.SetUseMesaClasses(1)
<a name="l00085"></a>00085             _image_fact = vtk.vtkImagingFactory()
<a name="l00086"></a>00086             _image_fact.SetUseMesaClasses(1)
<a name="l00087"></a>00087             del _graphics_fact
<a name="l00088"></a>00088             del _image_fact
<a name="l00089"></a>00089             del v
<a name="l00090"></a>00090         <span class="keywordflow">except</span> Exception, msg:
<a name="l00091"></a>00091             <span class="keywordflow">print</span> <span class="stringliteral">"No mesa"</span>, msg
<a name="l00092"></a>00092 
<a name="l00093"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#75c8669feff7d19387a2aec53435e593">00093</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#75c8669feff7d19387a2aec53435e593">_create_Tk_gui</a>(self):
<a name="l00094"></a>00094         fig = self.gcf()
<a name="l00095"></a>00095         <span class="keywordflow">if</span> self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#9b71d9b5ef9272afa3b48961093e121d">_master</a>_master <span class="keywordflow">is</span> <span class="keywordtype">None</span>:
<a name="l00096"></a>00096             self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#9b71d9b5ef9272afa3b48961093e121d">_master</a>_master = Tkinter.Tk()
<a name="l00097"></a>00097             self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#9b71d9b5ef9272afa3b48961093e121d">_master</a>_master.withdraw()
<a name="l00098"></a>00098         fig._root = Tkinter.Toplevel(self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#9b71d9b5ef9272afa3b48961093e121d">_master</a>_master)
<a name="l00099"></a>00099         fig._root.title(<span class="stringliteral">"EasyViz Data Visualizer - Figure %d"</span> % \
<a name="l00100"></a>00100                         self._attrs[<span class="stringliteral">'curfig'</span>])
<a name="l00101"></a>00101         <span class="comment"># if the window is closed, we should delete the current figure and</span>
<a name="l00102"></a>00102         <span class="comment"># create a new one.</span>
<a name="l00103"></a>00103         <span class="keyword">def </span>_close_fig(event=None):
<a name="l00104"></a>00104             self.clf()
<a name="l00105"></a>00105             fig._root.withdraw()
<a name="l00106"></a>00106         fig._root.protocol(<span class="stringliteral">"WM_DELETE_WINDOW"</span>, _close_fig)
<a name="l00107"></a>00107         fig._root.minsize(200, 200)
<a name="l00108"></a>00108         fig._root.bind(<span class="stringliteral">"&lt;KeyPress-q&gt;"</span>, _close_fig)
<a name="l00109"></a>00109         fig._root.withdraw()
<a name="l00110"></a>00110         master_f = Tkinter.Frame(fig._root, relief=<span class="stringliteral">'sunken'</span>, bd=2)
<a name="l00111"></a>00111         master_f.pack(side=<span class="stringliteral">'top'</span>, fill=<span class="stringliteral">'both'</span>, expand=1)
<a name="l00112"></a>00112         renwin_frame = Tkinter.Frame(master_f)
<a name="l00113"></a>00113         renwin_frame.pack(side=<span class="stringliteral">'left'</span>, fill=<span class="stringliteral">'both'</span>, expand=1)
<a name="l00114"></a>00114         frame = Tkinter.Frame(renwin_frame)
<a name="l00115"></a>00115         frame.pack(side=<span class="stringliteral">'top'</span>, fill=<span class="stringliteral">'both'</span>, expand=1)
<a name="l00116"></a>00116         <span class="keywordflow">try</span>:
<a name="l00117"></a>00117             width, height = fig.get(<span class="stringliteral">'size'</span>)
<a name="l00118"></a>00118         <span class="keywordflow">except</span> TypeError:
<a name="l00119"></a>00119             width, height = (640, 480)
<a name="l00120"></a>00120         tkw = vtkTkRenderWidget.vtkTkRenderWidget(frame, width=width, height=height)
<a name="l00121"></a>00121         tkw.pack(expand=<span class="stringliteral">'true'</span>, fill=<span class="stringliteral">'both'</span>)
<a name="l00122"></a>00122         renwin = tkw.GetRenderWindow()
<a name="l00123"></a>00123         <span class="comment">#renwin.SetSize(width, height)</span>
<a name="l00124"></a>00124         renwin.SetSize(width+1, height+1)
<a name="l00125"></a>00125         <span class="comment">#renwin.LineSmoothingOn()</span>
<a name="l00126"></a>00126         <span class="comment">#tkw.UpdateRenderer(0.0, 0.0)</span>
<a name="l00127"></a>00127         <span class="comment">#renwin.Render()</span>
<a name="l00128"></a>00128         <span class="keywordflow">return</span> renwin
<a name="l00129"></a>00129     
<a name="l00130"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#f613fb9c798e32c34dd9cf87179ad2a5">00130</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#f613fb9c798e32c34dd9cf87179ad2a5">_create_wx_gui</a>(self): <span class="comment"># eventually change this so it invokes the main graphics panel</span>
<a name="l00131"></a>00131         <span class="comment"># instead of this substitute</span>
<a name="l00132"></a>00132         <span class="comment"># Make a frame to show it</span>
<a name="l00133"></a>00133         app = wx.PySimpleApp()
<a name="l00134"></a>00134         frame = wx.Frame(<span class="keywordtype">None</span>, wx.ID_ANY, <span class="stringliteral">"Graphics"</span>, size=(1110, 590))
<a name="l00135"></a>00135         wxRW = wxVTKRenderWindow(frame, -1)
<a name="l00136"></a>00136 <span class="comment">#        ren = vtk.vtkRenderer()</span>
<a name="l00137"></a>00137 <span class="comment">#        widget.GetRenderWindow().AddRenderer(ren) </span>
<a name="l00138"></a>00138 
<a name="l00139"></a>00139         <span class="comment"># Layout the window</span>
<a name="l00140"></a>00140         pan=wx.Panel(frame,-1)
<a name="l00141"></a>00141         sizer = wx.BoxSizer(wx.VERTICAL)
<a name="l00142"></a>00142         sizer.Add(wxRW, 1, wx.LEFT|wx.TOP|wx.GROW)
<a name="l00143"></a>00143         pan.SetSizer(sizer) 
<a name="l00144"></a>00144 
<a name="l00145"></a>00145         frame.Show()
<a name="l00146"></a>00146         app.MainLoop()
<a name="l00147"></a>00147 
<a name="l00148"></a>00148         <span class="keywordflow">return</span> widget.GetRenderWindow()
<a name="l00149"></a>00149 
<a name="l00150"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#0eec4cd63959705bcceb60041715a97c">00150</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#0eec4cd63959705bcceb60041715a97c">_set_view_old</a>(self):
<a name="l00151"></a>00151         axis_cam = self._axis.get(<span class="stringliteral">'camera'</span>)
<a name="l00152"></a>00152         <span class="keywordflow">if</span> <span class="keywordflow">not</span> hasattr(self._axis, <span class="stringliteral">'_vtk_camera'</span>):
<a name="l00153"></a>00153             <span class="comment"># initialize camera:</span>
<a name="l00154"></a>00154             <span class="keywordflow">pass</span>
<a name="l00155"></a>00155         <span class="keywordflow">else</span>:
<a name="l00156"></a>00156             <span class="comment"># alter camera:</span>
<a name="l00157"></a>00157             <span class="keywordflow">pass</span>
<a name="l00158"></a>00158         camera = vtk.vtkCamera()
<a name="l00159"></a>00159         self._axis._renderer.SetActiveCamera(camera)
<a name="l00160"></a>00160         <span class="keywordflow">if</span> axis_cam.get(<span class="stringliteral">'camproj'</span>) == <span class="stringliteral">'perspective'</span>:
<a name="l00161"></a>00161             camera.ParallelProjectionOff()
<a name="l00162"></a>00162         <span class="keywordflow">else</span>:
<a name="l00163"></a>00163             camera.ParallelProjectionOn()
<a name="l00164"></a>00164         fp = axis_cam.get(<span class="stringliteral">'camtarget'</span>)
<a name="l00165"></a>00165         camera.SetFocalPoint(fp)
<a name="l00166"></a>00166         camera.SetViewUp(axis_cam.get(<span class="stringliteral">'camup'</span>))
<a name="l00167"></a>00167         <span class="keywordflow">if</span> axis_cam.get(<span class="stringliteral">'cammode'</span>) == <span class="stringliteral">'auto'</span>:
<a name="l00168"></a>00168             <span class="keywordflow">if</span> axis_cam.get(<span class="stringliteral">'view'</span>) == 3:
<a name="l00169"></a>00169                 camera.SetPosition(fp[0],fp[1]-1,fp[2])
<a name="l00170"></a>00170                 camera.Azimuth(-37.5)
<a name="l00171"></a>00171                 camera.Elevation(30)
<a name="l00172"></a>00172             <span class="keywordflow">else</span>:
<a name="l00173"></a>00173                 camera.SetPosition(fp[0], fp[1], 1)
<a name="l00174"></a>00174         <span class="keywordflow">else</span>:
<a name="l00175"></a>00175             camera.SetPosition(axis_cam.get(<span class="stringliteral">'campos'</span>))
<a name="l00176"></a>00176         <span class="comment">#camera.ComputeViewPlaneNormal()</span>
<a name="l00177"></a>00177         <span class="comment">#camera.OrthogonalizeViewUp()</span>
<a name="l00178"></a>00178         <span class="keywordflow">if</span> axis_cam.get(<span class="stringliteral">'camva'</span>) <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:
<a name="l00179"></a>00179             camera.SetViewAngle(axis_cam.get(<span class="stringliteral">'camva'</span>))
<a name="l00180"></a>00180         azimuth = axis_cam.get(<span class="stringliteral">'azimuth'</span>)
<a name="l00181"></a>00181         <span class="keywordflow">if</span> azimuth <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:
<a name="l00182"></a>00182             <span class="keywordflow">if</span> axis_cam.get(<span class="stringliteral">'view'</span>) == 3:
<a name="l00183"></a>00183                 azimuth += 37.5 <span class="comment"># compensate for above</span>
<a name="l00184"></a>00184             camera.Azimuth(azimuth)
<a name="l00185"></a>00185         elevation = axis_cam.get(<span class="stringliteral">'elevation'</span>)
<a name="l00186"></a>00186         <span class="keywordflow">if</span> elevation <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:
<a name="l00187"></a>00187             <span class="keywordflow">if</span> axis_cam.get(<span class="stringliteral">'view'</span>) == 3:
<a name="l00188"></a>00188                 elevation -= 30 <span class="comment"># compensate for above</span>
<a name="l00189"></a>00189             camera.Elevation(elevation)
<a name="l00190"></a>00190         <span class="comment"># make all actors fit inside the current scene:</span>
<a name="l00191"></a>00191         self._axis._renderer.ResetCamera()
<a name="l00192"></a>00192         camera.Zoom(axis_cam.get(<span class="stringliteral">'camzoom'</span>))
<a name="l00193"></a>00193         self._axis._vtk_camera = camera
<a name="l00194"></a>00194 
<a name="l00195"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#09cc977be05655099717d8d2f5445273">00195</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#09cc977be05655099717d8d2f5445273">_initialize_camera</a>(self):
<a name="l00196"></a>00196         ax_cam = self._axis.get(<span class="stringliteral">'camera'</span>)
<a name="l00197"></a>00197         camera = vtk.vtkCamera()
<a name="l00198"></a>00198         fp = ax_cam.get(<span class="stringliteral">'camtarget'</span>)
<a name="l00199"></a>00199         camera.SetFocalPoint(fp)
<a name="l00200"></a>00200         camera.SetViewUp(ax_cam.get(<span class="stringliteral">'camup'</span>))
<a name="l00201"></a>00201         <span class="keywordflow">if</span> ax_cam.get(<span class="stringliteral">'cammode'</span>) == <span class="stringliteral">'auto'</span>:
<a name="l00202"></a>00202             <span class="keywordflow">if</span> ax_cam.get(<span class="stringliteral">'view'</span>) == 3:
<a name="l00203"></a>00203                 camera.SetPosition(fp[0],fp[1]-1,fp[2])
<a name="l00204"></a>00204                 camera.Azimuth(-37.5)
<a name="l00205"></a>00205                 camera.Elevation(30)
<a name="l00206"></a>00206             <span class="keywordflow">else</span>:
<a name="l00207"></a>00207                 camera.SetPosition(fp[0], fp[1], 1)
<a name="l00208"></a>00208         <span class="keywordflow">else</span>:
<a name="l00209"></a>00209             camera.SetPosition(ax_cam.get(<span class="stringliteral">'campos'</span>))
<a name="l00210"></a>00210         azimuth = ax_cam.get(<span class="stringliteral">'azimuth'</span>)
<a name="l00211"></a>00211         <span class="keywordflow">if</span> azimuth <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:
<a name="l00212"></a>00212             <span class="keywordflow">if</span> ax_cam.get(<span class="stringliteral">'view'</span>) == 3:
<a name="l00213"></a>00213                 azimuth += 37.5 <span class="comment"># compensate for above</span>
<a name="l00214"></a>00214             camera.Azimuth(azimuth)
<a name="l00215"></a>00215         elevation = ax_cam.get(<span class="stringliteral">'elevation'</span>)
<a name="l00216"></a>00216         <span class="keywordflow">if</span> elevation <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:
<a name="l00217"></a>00217             <span class="keywordflow">if</span> ax_cam.get(<span class="stringliteral">'view'</span>) == 3:
<a name="l00218"></a>00218                 elevation -= 30 <span class="comment"># compensate for above</span>
<a name="l00219"></a>00219             camera.Elevation(elevation)
<a name="l00220"></a>00220 
<a name="l00221"></a>00221         <span class="keywordflow">return</span> camera
<a name="l00222"></a>00222 
<a name="l00223"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#44daec5e1b8c1c648ecb7218af777fdb">00223</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#44daec5e1b8c1c648ecb7218af777fdb">_update_camera</a>(self):
<a name="l00224"></a>00224         ax_cam = self._axis.get(<span class="stringliteral">'camera'</span>)
<a name="l00225"></a>00225         camera = self._axis._vtk_camera
<a name="l00226"></a>00226         <span class="keywordflow">return</span> camera
<a name="l00227"></a>00227 
<a name="l00228"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#a8821dd3e3b91910b38813594a31942a">00228</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#a8821dd3e3b91910b38813594a31942a">_set_view</a>(self):
<a name="l00229"></a>00229         ax_cam = self._axis.get(<span class="stringliteral">'camera'</span>)
<a name="l00230"></a>00230         <span class="keywordflow">if</span> <span class="keywordflow">not</span> hasattr(self._axis, <span class="stringliteral">'_vtk_camera'</span>):
<a name="l00231"></a>00231             camera = self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#09cc977be05655099717d8d2f5445273">_initialize_camera</a>_initialize_camera()
<a name="l00232"></a>00232         <span class="keywordflow">else</span>:
<a name="l00233"></a>00233             <span class="comment">#camera = self._update_camera()</span>
<a name="l00234"></a>00234             camera = self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#09cc977be05655099717d8d2f5445273">_initialize_camera</a>_initialize_camera()
<a name="l00235"></a>00235 
<a name="l00236"></a>00236         <span class="keywordflow">if</span> ax_cam.get(<span class="stringliteral">'camroll'</span>) <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:
<a name="l00237"></a>00237             camera.Roll(ax_cam.get(<span class="stringliteral">'camroll'</span>))
<a name="l00238"></a>00238 
<a name="l00239"></a>00239         <span class="keywordflow">if</span> ax_cam.get(<span class="stringliteral">'camva'</span>) <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:
<a name="l00240"></a>00240             camera.SetViewAngle(ax_cam.get(<span class="stringliteral">'camva'</span>))
<a name="l00241"></a>00241  
<a name="l00242"></a>00242         <span class="keywordflow">if</span> ax_cam.get(<span class="stringliteral">'camproj'</span>) == <span class="stringliteral">'perspective'</span>:
<a name="l00243"></a>00243             camera.ParallelProjectionOff()
<a name="l00244"></a>00244         <span class="keywordflow">else</span>:
<a name="l00245"></a>00245             camera.ParallelProjectionOn()
<a name="l00246"></a>00246             
<a name="l00247"></a>00247         self._axis._renderer.SetActiveCamera(camera)
<a name="l00248"></a>00248         self._axis._vtk_camera = camera
<a name="l00249"></a>00249 
<a name="l00250"></a>00250         <span class="comment"># make sure all actors are inside the current view:</span>
<a name="l00251"></a>00251         ren = self._axis._renderer
<a name="l00252"></a>00252         ren.ResetCamera()
<a name="l00253"></a>00253         <span class="keywordflow">if</span> self._axis.get(<span class="stringliteral">'camera'</span>).get(<span class="stringliteral">'view'</span>) == 2:
<a name="l00254"></a>00254             ren.GetActiveCamera().Zoom(1.5)
<a name="l00255"></a>00255         camera.Zoom(ax_cam.get(<span class="stringliteral">'camzoom'</span>))
<a name="l00256"></a>00256        
<a name="l00257"></a>00257         <span class="comment"># set the camera in the vtkCubeAxesActor2D object:</span>
<a name="l00258"></a>00258         self._axis._vtk_axes.SetCamera(camera)
<a name="l00259"></a>00259 
<a name="l00260"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#1fb45b32558a5ebf64d5fe103cf0279b">00260</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#1fb45b32558a5ebf64d5fe103cf0279b">_create_labeled_axes</a>(self):
<a name="l00261"></a>00261         ax = self._axis
<a name="l00262"></a>00262         <span class="keywordflow">if</span> <span class="keywordflow">not</span> hasattr(ax, <span class="stringliteral">'_vtk_axes'</span>):
<a name="l00263"></a>00263             ax._vtk_axes = vtk.vtkCubeAxesActor2D()
<a name="l00264"></a>00264         <span class="keywordflow">if</span> ax.get(<span class="stringliteral">'visible'</span>):
<a name="l00265"></a>00265             tprop = vtk.vtkTextProperty()
<a name="l00266"></a>00266             tprop.SetColor(ax.get(<span class="stringliteral">'fgcolor'</span>))
<a name="l00267"></a>00267             tprop.SetFontSize(ax.get(<span class="stringliteral">'fontsize'</span>))
<a name="l00268"></a>00268             tprop.SetShadow(0)
<a name="l00269"></a>00269             tprop.SetBold(0)
<a name="l00270"></a>00270             mode = ax.get(<span class="stringliteral">'mode'</span>)
<a name="l00271"></a>00271             <span class="keywordflow">if</span> mode <span class="keywordflow">in</span> [<span class="stringliteral">'auto'</span>, <span class="stringliteral">'tight'</span>]:
<a name="l00272"></a>00272                 dar = ax.get(<span class="stringliteral">'daspect'</span>)
<a name="l00273"></a>00273                 bounds = b = list(ax._vtk_apd.GetOutput().GetBounds())
<a name="l00274"></a>00274                 <span class="keywordflow">if</span> mode == <span class="stringliteral">'auto'</span>:
<a name="l00275"></a>00275                     incr = 0.1
<a name="l00276"></a>00276                     dx = float(b[1] - b[0])
<a name="l00277"></a>00277                     dy = float(b[3] - b[2])
<a name="l00278"></a>00278                     dz = float(b[5] - b[4])
<a name="l00279"></a>00279                     <span class="comment">#b[0] -= dx*incr;  b[1] += dx*incr</span>
<a name="l00280"></a>00280                     <span class="comment">#b[2] -= dy*incr;  b[3] += dy*incr</span>
<a name="l00281"></a>00281                     <span class="comment">#b[4] -= dz*incr;  b[5] += dz*incr</span>
<a name="l00282"></a>00282                 unscaled_bounds = ub = bounds[:]
<a name="l00283"></a>00283                 ub[0] *= dar[0];  ub[1] *= dar[0]
<a name="l00284"></a>00284                 ub[2] *= dar[1];  ub[3] *= dar[1]
<a name="l00285"></a>00285                 ub[4] *= dar[2];  ub[5] *= dar[2]
<a name="l00286"></a>00286             <span class="keywordflow">elif</span> mode == <span class="stringliteral">'fill'</span>:
<a name="l00287"></a>00287                 <span class="keywordflow">print</span> <span class="stringliteral">"axis mode 'fill' not implemented in VtkBackend"</span>
<a name="l00288"></a>00288             <span class="keywordflow">elif</span> mode == <span class="stringliteral">'manual'</span>:
<a name="l00289"></a>00289                 bounds = ax._vtk_scaled_bounds
<a name="l00290"></a>00290                 unscaled_bounds = ax._vtk_bounds
<a name="l00291"></a>00291             <span class="comment">#cube_axes = vtk.vtkCubeAxesActor2D()</span>
<a name="l00292"></a>00292             ax._vtk_axes.SetBounds(bounds)
<a name="l00293"></a>00293             ax._vtk_axes.SetRanges(unscaled_bounds)
<a name="l00294"></a>00294             ax._vtk_axes.UseRangesOn()
<a name="l00295"></a>00295             <span class="comment">#ax._vtk_axes.SetCamera(ax._vtk_camera)</span>
<a name="l00296"></a>00296             ax._vtk_axes.SetLabelFormat(<span class="stringliteral">"%6.3g"</span>)
<a name="l00297"></a>00297             ax._vtk_axes.SetFlyModeToOuterEdges()
<a name="l00298"></a>00298             <span class="comment">#ax._vtk_axes.SetFontFactor(ax.get('fontsize')/10.)</span>
<a name="l00299"></a>00299             ax._vtk_axes.ScalingOff()
<a name="l00300"></a>00300             ax._vtk_axes.SetAxisTitleTextProperty(tprop)
<a name="l00301"></a>00301             ax._vtk_axes.SetAxisLabelTextProperty(tprop)
<a name="l00302"></a>00302             ax._vtk_axes.GetProperty().SetColor(ax.get(<span class="stringliteral">'fgcolor'</span>))
<a name="l00303"></a>00303             ax._vtk_axes.SetCornerOffset(0)
<a name="l00304"></a>00304             ax._vtk_axes.SetNumberOfLabels(5)
<a name="l00305"></a>00305             ax._vtk_axes.SetXLabel(ax.get(<span class="stringliteral">'xlabel'</span>))
<a name="l00306"></a>00306             ax._vtk_axes.SetYLabel(ax.get(<span class="stringliteral">'ylabel'</span>))
<a name="l00307"></a>00307             ax._vtk_axes.SetZLabel(ax.get(<span class="stringliteral">'zlabel'</span>))
<a name="l00308"></a>00308             <span class="keywordflow">if</span> ax.get(<span class="stringliteral">'camera'</span>).get(<span class="stringliteral">'view'</span>) == 2:
<a name="l00309"></a>00309                 ax._vtk_axes.YAxisVisibilityOff()
<a name="l00310"></a>00310             <span class="keywordflow">else</span>:
<a name="l00311"></a>00311                 ax._vtk_axes.YAxisVisibilityOn()
<a name="l00312"></a>00312             ax._renderer.AddActor(ax._vtk_axes)
<a name="l00313"></a>00313             ax._vtk_box_bounds = bounds
<a name="l00314"></a>00314 
<a name="l00315"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#e09806cca66432defeabd595b0b3ce6f">00315</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#e09806cca66432defeabd595b0b3ce6f">_set_box_state</a>(self):
<a name="l00316"></a>00316         ax = self._axis
<a name="l00317"></a>00317         <span class="keywordflow">if</span> <span class="keywordflow">not</span> hasattr(ax, <span class="stringliteral">'_vtk_box'</span>):
<a name="l00318"></a>00318             ax._vtk_box = vtk.vtkActor()
<a name="l00319"></a>00319         <span class="comment"># remove old box (if present):</span>
<a name="l00320"></a>00320         <span class="keywordflow">if</span> ax._renderer.GetActors().IsItemPresent(ax._vtk_box):
<a name="l00321"></a>00321             ax._renderer.RemoveActor(ax._vtk_box)
<a name="l00322"></a>00322         <span class="keywordflow">if</span> ax.get(<span class="stringliteral">'box'</span>):
<a name="l00323"></a>00323             box = vtk.vtkCubeSource()
<a name="l00324"></a>00324             <span class="comment">#box.SetBounds(ax._vtk_scaled_bounds)</span>
<a name="l00325"></a>00325             box.SetBounds(ax._vtk_box_bounds)
<a name="l00326"></a>00326             box.Update()
<a name="l00327"></a>00327             outline = vtk.vtkOutlineFilter()
<a name="l00328"></a>00328             outline.SetInput(box.GetOutput())
<a name="l00329"></a>00329             mapper = vtk.vtkPolyDataMapper()
<a name="l00330"></a>00330             mapper.SetInput(outline.GetOutput())
<a name="l00331"></a>00331             ax._vtk_box.SetMapper(mapper)
<a name="l00332"></a>00332             ax._vtk_box.GetProperty().SetColor(ax.get(<span class="stringliteral">'fgcolor'</span>))
<a name="l00333"></a>00333             ax._renderer.AddActor(ax._vtk_box)
<a name="l00334"></a>00334 
<a name="l00335"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#1cd7e115255fc4a2b276d0edb9414ba5">00335</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#1cd7e115255fc4a2b276d0edb9414ba5">_set_colormap</a>(self):
<a name="l00336"></a>00336         colormap = self._axis.get(<span class="stringliteral">'colormap'</span>)
<a name="l00337"></a>00337         <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(colormap, vtk.vtkLookupTable):
<a name="l00338"></a>00338             colormap = self.jet() <span class="comment"># use default colormap</span>
<a name="l00339"></a>00339         self._axis._vtk_colormap = colormap
<a name="l00340"></a>00340 
<a name="l00341"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#a5f17210857091feb358bc3880b07f34">00341</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#a5f17210857091feb358bc3880b07f34">_set_colorbar</a>(self):
<a name="l00342"></a>00342         ax = self._axis
<a name="l00343"></a>00343         cbar = ax.get(<span class="stringliteral">'colorbar'</span>)
<a name="l00344"></a>00344 
<a name="l00345"></a>00345         <span class="keywordflow">if</span> <span class="keywordflow">not</span> hasattr(ax, <span class="stringliteral">'_vtk_colorbar'</span>):
<a name="l00346"></a>00346             ax._vtk_colorbar = vtk.vtkScalarBarActor()
<a name="l00347"></a>00347         <span class="keywordflow">if</span> ax._renderer.GetActors().IsItemPresent(ax._vtk_colorbar):
<a name="l00348"></a>00348             ax._renderer.RemoveActor2D(ax._vtk_colorbar)
<a name="l00349"></a>00349         <span class="keywordflow">if</span> cbar.get(<span class="stringliteral">'visible'</span>):
<a name="l00350"></a>00350             cblocation = cbar.get(<span class="stringliteral">'cblocation'</span>)
<a name="l00351"></a>00351             cbloc = self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#d04cef15148842eecfb491aea9143087">_colorbar_locations</a>_colorbar_locations[cblocation]
<a name="l00352"></a>00352             ax._vtk_colorbar.SetLookupTable(ax._vtk_colormap)
<a name="l00353"></a>00353             <span class="keywordflow">if</span> <span class="stringliteral">'North'</span> <span class="keywordflow">in</span> cblocation <span class="keywordflow">or</span> <span class="stringliteral">'South'</span> <span class="keywordflow">in</span> cblocation:
<a name="l00354"></a>00354                 ax._vtk_colorbar.SetOrientationToHorizontal()
<a name="l00355"></a>00355             <span class="keywordflow">else</span>:
<a name="l00356"></a>00356                 ax._vtk_colorbar.SetOrientationToVertical()
<a name="l00357"></a>00357             ax._vtk_colorbar.SetTitle(cbar.get(<span class="stringliteral">'cbtitle'</span>))
<a name="l00358"></a>00358             ax._vtk_colorbar.SetPosition(*cbloc[0])
<a name="l00359"></a>00359             ax._vtk_colorbar.SetPosition2(*cbloc[1])
<a name="l00360"></a>00360             tprop = vtk.vtkTextProperty()
<a name="l00361"></a>00361             tprop.SetColor(ax.get(<span class="stringliteral">'fgcolor'</span>))
<a name="l00362"></a>00362             tprop.SetFontSize(ax.get(<span class="stringliteral">'fontsize'</span>))
<a name="l00363"></a>00363             tprop.ShadowOff()
<a name="l00364"></a>00364             ax._vtk_colorbar.SetTitleTextProperty(tprop)
<a name="l00365"></a>00365             ax._vtk_colorbar.SetLabelTextProperty(tprop)
<a name="l00366"></a>00366             ax._renderer.AddActor(ax._vtk_colorbar)
<a name="l00367"></a>00367 
<a name="l00368"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#e8f0b8d199ab9da7757ba2d087017a6a">00368</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#e8f0b8d199ab9da7757ba2d087017a6a">_set_shading</a>(self, item, source, actor):
<a name="l00369"></a>00369         shading = self._axis.get(<span class="stringliteral">'shading'</span>)
<a name="l00370"></a>00370         <span class="keywordflow">if</span> shading == <span class="stringliteral">'interp'</span>:
<a name="l00371"></a>00371             actor.GetProperty().SetInterpolationToGouraud()
<a name="l00372"></a>00372         <span class="keywordflow">elif</span> shading == <span class="stringliteral">'flat'</span>:
<a name="l00373"></a>00373             actor.GetProperty().SetInterpolationToFlat()
<a name="l00374"></a>00374         <span class="keywordflow">else</span>: <span class="comment"># use default shading ('faceted')</span>
<a name="l00375"></a>00375             actor.GetProperty().SetInterpolationToFlat()
<a name="l00376"></a>00376             edges = vtk.vtkExtractEdges()
<a name="l00377"></a>00377             edges.SetInput(source.GetOutput())
<a name="l00378"></a>00378             edges.Update()
<a name="l00379"></a>00379             mapper = vtk.vtkPolyDataMapper()
<a name="l00380"></a>00380             mapper.SetInput(edges.GetOutput())
<a name="l00381"></a>00381             mapper.ScalarVisibilityOff()
<a name="l00382"></a>00382             mapper.SetResolveCoincidentTopologyToPolygonOffset()
<a name="l00383"></a>00383             mesh = vtk.vtkActor()
<a name="l00384"></a>00384             mesh.SetMapper(mapper)
<a name="l00385"></a>00385             color = item.get(<span class="stringliteral">'linecolor'</span>)
<a name="l00386"></a>00386             <span class="keywordflow">if</span> color == <span class="stringliteral">''</span> <span class="keywordflow">or</span> color <span class="keywordflow">is</span> <span class="keywordtype">None</span>:
<a name="l00387"></a>00387                 color = (0,0,0) <span class="comment"># use black as default</span>
<a name="l00388"></a>00388             <span class="keywordflow">elif</span> <span class="keywordflow">not</span> isinstance(color, (tuple,list)):
<a name="l00389"></a>00389                 <span class="keywordflow">try</span>: color = self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#aa21ce1c55d4f085fa7333368c0dabfd">_colors</a>_colors[color]
<a name="l00390"></a>00390                 <span class="keywordflow">except</span>: color = (0,0,0) <span class="comment"># use black as default</span>
<a name="l00391"></a>00391             mesh.GetProperty().SetColor(color)
<a name="l00392"></a>00392             self._axis._renderer.AddActor(mesh)
<a name="l00393"></a>00393 
<a name="l00394"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#cfd5162ec60121e4ef3a249f1684bd16">00394</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#cfd5162ec60121e4ef3a249f1684bd16">_set_title</a>(self):
<a name="l00395"></a>00395         tprop = vtk.vtkTextProperty()
<a name="l00396"></a>00396         tprop.BoldOff()
<a name="l00397"></a>00397         tprop.SetFontSize(self._axis.get(<span class="stringliteral">'fontsize'</span>))
<a name="l00398"></a>00398         tprop.SetColor(self._axis.get(<span class="stringliteral">'fgcolor'</span>))
<a name="l00399"></a>00399         tprop.SetFontFamilyToArial()
<a name="l00400"></a>00400         tprop.SetVerticalJustificationToTop()
<a name="l00401"></a>00401         tprop.SetJustificationToCentered()
<a name="l00402"></a>00402         mapper = vtk.vtkTextMapper()
<a name="l00403"></a>00403         mapper.SetInput(self._axis.get(<span class="stringliteral">'title'</span>))
<a name="l00404"></a>00404         mapper.SetTextProperty(tprop)
<a name="l00405"></a>00405         actor = vtk.vtkActor2D()
<a name="l00406"></a>00406         actor.SetMapper(mapper)
<a name="l00407"></a>00407         actor.GetPositionCoordinate().SetCoordinateSystemToView()
<a name="l00408"></a>00408         actor.GetPositionCoordinate().SetValue(0.0, 0.95)
<a name="l00409"></a>00409         self._axis._renderer.AddActor(actor)
<a name="l00410"></a>00410 
<a name="l00411"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#4a511b694fa94a4f33a53f44046db8fb">00411</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#4a511b694fa94a4f33a53f44046db8fb">_set_caxis</a>(self):
<a name="l00412"></a>00412         <span class="keywordflow">if</span> self._axis.get(<span class="stringliteral">'caxismode'</span>) == <span class="stringliteral">'auto'</span>:
<a name="l00413"></a>00413             caxis = <span class="keywordtype">None</span>
<a name="l00414"></a>00414         <span class="keywordflow">else</span>:
<a name="l00415"></a>00415             caxis = self._axis.get(<span class="stringliteral">'caxis'</span>)
<a name="l00416"></a>00416         self._axis._vtk_caxis = caxis
<a name="l00417"></a>00417         
<a name="l00418"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#4f64ad7ffb58475f6df55c5f04d3f915">00418</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#4f64ad7ffb58475f6df55c5f04d3f915">_data_inside_bounds</a>(self, data):
<a name="l00419"></a>00419         fb = self._axis._vtk_scaled_bounds
<a name="l00420"></a>00420         bounds = data.GetBounds()
<a name="l00421"></a>00421         <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(0, len(fb), 2):
<a name="l00422"></a>00422             <span class="keywordflow">if</span> bounds[i] &lt; fb[i] <span class="keywordflow">and</span> <span class="keywordflow">not</span> allclose(bounds[i],fb[i]):
<a name="l00423"></a>00423                 <span class="keywordflow">return</span> <span class="keyword">False</span>
<a name="l00424"></a>00424         <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(1, len(fb), 2):
<a name="l00425"></a>00425             <span class="keywordflow">if</span> bounds[i] &gt; fb[i] <span class="keywordflow">and</span> <span class="keywordflow">not</span> allclose(bounds[i],fb[i]):
<a name="l00426"></a>00426                 <span class="keywordflow">return</span> <span class="keyword">False</span>
<a name="l00427"></a>00427         <span class="keywordflow">return</span> <span class="keyword">True</span>
<a name="l00428"></a>00428 
<a name="l00429"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#fe179a08cd689957492209082af686a7">00429</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#fe179a08cd689957492209082af686a7">_cut_data</a>(self, indata):
<a name="l00430"></a>00430         <span class="keywordflow">if</span> self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#4f64ad7ffb58475f6df55c5f04d3f915">_data_inside_bounds</a>_data_inside_bounds(indata.GetOutput()):
<a name="l00431"></a>00431             <span class="keywordflow">return</span> indata
<a name="l00432"></a>00432         box = vtk.vtkBox()
<a name="l00433"></a>00433         box.SetBounds(self._axis._vtk_scaled_bounds)
<a name="l00434"></a>00434         clipper = vtk.vtkClipPolyData()
<a name="l00435"></a>00435         clipper.SetInput(indata.GetOutput())
<a name="l00436"></a>00436         clipper.SetClipFunction(box)
<a name="l00437"></a>00437         <span class="comment">#clipper.GenerateClipScalarsOn()</span>
<a name="l00438"></a>00438         <span class="comment">#clipper.GenerateClippedOutputOn()</span>
<a name="l00439"></a>00439         clipper.SetValue(0.0)
<a name="l00440"></a>00440         clipper.InsideOutOn()
<a name="l00441"></a>00441         clipper.Update()
<a name="l00442"></a>00442         <span class="keywordflow">return</span> clipper
<a name="l00443"></a>00443 
<a name="l00444"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#8ff7dfa7a74b145a301fc723b2066ba0">00444</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#8ff7dfa7a74b145a301fc723b2066ba0">_add_slices</a>(self, item, sgrid, contours=False):
<a name="l00445"></a>00445         cvector = item.get(<span class="stringliteral">'cvector'</span>)
<a name="l00446"></a>00446         center = sgrid.GetCenter()
<a name="l00447"></a>00447         dar = self._axis.get(<span class="stringliteral">'daspect'</span>)
<a name="l00448"></a>00448         sx, sy, sz = item.get(<span class="stringliteral">'slices'</span>)
<a name="l00449"></a>00449         <span class="keywordflow">if</span> len(shape(sx)) == 2 <span class="keywordflow">and</span> shape(sx) == shape(sy) == shape(sz):
<a name="l00450"></a>00450             s = Surface(sx,sy,sz)
<a name="l00451"></a>00451             sgrid2 = self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#d5a343d39b9ceac0cef05c829a0298bb">_get_2d_structured_grid</a>_get_2d_structured_grid(s)
<a name="l00452"></a>00452             plane = vtk.vtkStructuredGridGeometryFilter()
<a name="l00453"></a>00453             plane.SetInput(sgrid2)
<a name="l00454"></a>00454             plane.Update()
<a name="l00455"></a>00455             data = self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#fe179a08cd689957492209082af686a7">_cut_data</a>_cut_data(plane)
<a name="l00456"></a>00456             implds = vtk.vtkImplicitDataSet()
<a name="l00457"></a>00457             implds.SetDataSet(data.GetOutput())
<a name="l00458"></a>00458             implds.Modified()
<a name="l00459"></a>00459             cut = vtk.vtkCutter()
<a name="l00460"></a>00460             cut.SetInput(sgrid)
<a name="l00461"></a>00461             cut.SetCutFunction(implds)
<a name="l00462"></a>00462             cut.GenerateValues(10, -2,2)
<a name="l00463"></a>00463             cut.GenerateCutScalarsOn()
<a name="l00464"></a>00464             cut.Update()
<a name="l00465"></a>00465             mapper = vtk.vtkPolyDataMapper()
<a name="l00466"></a>00466             mapper.SetInput(cut.GetOutput())
<a name="l00467"></a>00467             mapper.SetLookupTable(self._axis._vtk_colormap)
<a name="l00468"></a>00468             caxis = self._axis.get(<span class="stringliteral">'caxis'</span>)
<a name="l00469"></a>00469             <span class="keywordflow">if</span> <span class="keywordtype">None</span> <span class="keywordflow">in</span> caxis:
<a name="l00470"></a>00470                 caxis = data.GetOutput().GetScalarRange()
<a name="l00471"></a>00471             mapper.SetScalarRange(caxis)
<a name="l00472"></a>00472             mapper.Update()
<a name="l00473"></a>00473             actor = vtk.vtkActor()
<a name="l00474"></a>00474             actor.SetMapper(mapper)
<a name="l00475"></a>00475             self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#e8f0b8d199ab9da7757ba2d087017a6a">_set_shading</a>_set_shading(item, data, actor)
<a name="l00476"></a>00476             self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#14fe82f5d7a1d12266a9cef33ce32bfe">_set_actor_properties</a>_set_actor_properties(item, actor)
<a name="l00477"></a>00477             self._axis._renderer.AddActor(actor)
<a name="l00478"></a>00478             self._axis._vtk_apd.AddInput(cut.GetOutput())
<a name="l00479"></a>00479             self._axis._vtk_apd.AddInput(data.GetOutput())
<a name="l00480"></a>00480         <span class="keywordflow">else</span>:
<a name="l00481"></a>00481             origins = []
<a name="l00482"></a>00482             normals = []
<a name="l00483"></a>00483             sx = ravel(sx)/dar[0]
<a name="l00484"></a>00484             sy = ravel(sy)/dar[1]
<a name="l00485"></a>00485             sz = ravel(sz)/dar[2]
<a name="l00486"></a>00486             <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(sx)):
<a name="l00487"></a>00487                 normals.append([1,0,0])
<a name="l00488"></a>00488                 origins.append([sx[i]/dar[0], center[1], center[2]])
<a name="l00489"></a>00489             <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(sy)):
<a name="l00490"></a>00490                 normals.append([0,1,0])
<a name="l00491"></a>00491                 origins.append([center[0], sy[i]/dar[1], center[2]])
<a name="l00492"></a>00492             <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(sz)):
<a name="l00493"></a>00493                 normals.append([0,0,1])
<a name="l00494"></a>00494                 origins.append([center[0], center[1], sz[i]/dar[2]])
<a name="l00495"></a>00495             <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(normals)):
<a name="l00496"></a>00496                 plane = vtk.vtkPlane()
<a name="l00497"></a>00497                 plane.SetOrigin(origins[i])
<a name="l00498"></a>00498                 plane.SetNormal(normals[i])
<a name="l00499"></a>00499                 cut = vtk.vtkCutter()
<a name="l00500"></a>00500                 cut.SetInput(sgrid)
<a name="l00501"></a>00501                 cut.SetCutFunction(plane)
<a name="l00502"></a>00502                 cut.Update()
<a name="l00503"></a>00503                 data = self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#fe179a08cd689957492209082af686a7">_cut_data</a>_cut_data(cut)
<a name="l00504"></a>00504                 mapper = vtk.vtkPolyDataMapper()
<a name="l00505"></a>00505                 <span class="keywordflow">if</span> contours:
<a name="l00506"></a>00506                     iso = vtk.vtkContourFilter()
<a name="l00507"></a>00507                     iso.SetInput(data.GetOutput())
<a name="l00508"></a>00508                     <span class="keywordflow">if</span> cvector <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:
<a name="l00509"></a>00509                         <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(cvector)):
<a name="l00510"></a>00510                             iso.SetValue(i, cvector[i])
<a name="l00511"></a>00511                     <span class="keywordflow">else</span>:
<a name="l00512"></a>00512                         zmin, zmax = data.GetOutput().GetScalarRange()
<a name="l00513"></a>00513                         iso.GenerateValues(item.get(<span class="stringliteral">'clevels'</span>), zmin, zmax)
<a name="l00514"></a>00514                     iso.Update()
<a name="l00515"></a>00515                     mapper.SetInput(iso.GetOutput())
<a name="l00516"></a>00516                 <span class="keywordflow">else</span>:
<a name="l00517"></a>00517                     mapper.SetInput(data.GetOutput())
<a name="l00518"></a>00518                 mapper.SetLookupTable(self._axis._vtk_colormap)
<a name="l00519"></a>00519                 caxis = self._axis.get(<span class="stringliteral">'caxis'</span>)
<a name="l00520"></a>00520                 <span class="keywordflow">if</span> <span class="keywordtype">None</span> <span class="keywordflow">in</span> caxis:
<a name="l00521"></a>00521                     caxis = sgrid.GetScalarRange()
<a name="l00522"></a>00522                 mapper.SetScalarRange(caxis)
<a name="l00523"></a>00523                 mapper.Update()
<a name="l00524"></a>00524                 actor = vtk.vtkActor()
<a name="l00525"></a>00525                 actor.SetMapper(mapper)
<a name="l00526"></a>00526                 <span class="keywordflow">if</span> <span class="keywordflow">not</span> contours:
<a name="l00527"></a>00527                     self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#e8f0b8d199ab9da7757ba2d087017a6a">_set_shading</a>_set_shading(item, data, actor)
<a name="l00528"></a>00528                 self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#14fe82f5d7a1d12266a9cef33ce32bfe">_set_actor_properties</a>_set_actor_properties(item, actor)
<a name="l00529"></a>00529                 self._axis._renderer.AddActor(actor)
<a name="l00530"></a>00530                 self._axis._vtk_apd.AddInput(cut.GetOutput())
<a name="l00531"></a>00531 
<a name="l00532"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#0a254deb062852cd58ea282944c6e092">00532</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#0a254deb062852cd58ea282944c6e092">_add_isosurface</a>(self, item, sgrid):
<a name="l00533"></a>00533         iso = vtk.vtkContourFilter()
<a name="l00534"></a>00534         iso.SetInput(sgrid)
<a name="l00535"></a>00535         iso.SetValue(0, item.get(<span class="stringliteral">'isovalue'</span>))
<a name="l00536"></a>00536         iso.Update()
<a name="l00537"></a>00537         data = self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#fe179a08cd689957492209082af686a7">_cut_data</a>_cut_data(iso)
<a name="l00538"></a>00538         normals = vtk.vtkPolyDataNormals()
<a name="l00539"></a>00539         normals.SetInput(data.GetOutput())
<a name="l00540"></a>00540         normals.SetFeatureAngle(45)
<a name="l00541"></a>00541         normals.Update()
<a name="l00542"></a>00542         mapper = vtk.vtkPolyDataMapper()
<a name="l00543"></a>00543         mapper.SetInput(normals.GetOutput())
<a name="l00544"></a>00544         mapper.SetLookupTable(self._axis._vtk_colormap)
<a name="l00545"></a>00545         caxis = self._axis.get(<span class="stringliteral">'caxis'</span>)
<a name="l00546"></a>00546         <span class="keywordflow">if</span> <span class="keywordtype">None</span> <span class="keywordflow">in</span> caxis:
<a name="l00547"></a>00547             caxis = sgrid.GetScalarRange()
<a name="l00548"></a>00548         mapper.SetScalarRange(caxis)
<a name="l00549"></a>00549         mapper.Update()
<a name="l00550"></a>00550         actor = vtk.vtkActor()
<a name="l00551"></a>00551         actor.SetMapper(mapper)
<a name="l00552"></a>00552         self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#e8f0b8d199ab9da7757ba2d087017a6a">_set_shading</a>_set_shading(item, data, actor)
<a name="l00553"></a>00553         self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#14fe82f5d7a1d12266a9cef33ce32bfe">_set_actor_properties</a>_set_actor_properties(item, actor)
<a name="l00554"></a>00554         self._axis._renderer.AddActor(actor)
<a name="l00555"></a>00555         self._axis._vtk_apd.AddInput(normals.GetOutput())
<a name="l00556"></a>00556 
<a name="l00557"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#d5a343d39b9ceac0cef05c829a0298bb">00557</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#d5a343d39b9ceac0cef05c829a0298bb">_get_2d_structured_grid</a>(self, item, vectors=False,
<a name="l00558"></a>00558                                 heights=<span class="keyword">True</span>, bottom=<span class="keyword">False</span>):
<a name="l00559"></a>00559         dar = self._axis.get(<span class="stringliteral">'daspect'</span>)
<a name="l00560"></a>00560         x = asarray(item.get(<span class="stringliteral">'xdata'</span>))/dar[0]
<a name="l00561"></a>00561         y = asarray(item.get(<span class="stringliteral">'ydata'</span>))/dar[1]
<a name="l00562"></a>00562         sgrid = vtk.vtkStructuredGrid()
<a name="l00563"></a>00563         sgrid.SetDimensions(item.get(<span class="stringliteral">'dims'</span>))
<a name="l00564"></a>00564         no_points = item.get(<span class="stringliteral">'numberofpoints'</span>)
<a name="l00565"></a>00565         points = vtk.vtkPoints()
<a name="l00566"></a>00566         points.SetNumberOfPoints(no_points)
<a name="l00567"></a>00567         <span class="keywordflow">if</span> vectors:
<a name="l00568"></a>00568             x = ravel(x)
<a name="l00569"></a>00569             y = ravel(y)
<a name="l00570"></a>00570             u = asarray(item.get(<span class="stringliteral">'udata'</span>))
<a name="l00571"></a>00571             v = ravel(item.get(<span class="stringliteral">'vdata'</span>))
<a name="l00572"></a>00572             w = ravel(item.get(<span class="stringliteral">'wdata'</span>))
<a name="l00573"></a>00573             z = ravel(item.get(<span class="stringliteral">'zdata'</span>))
<a name="l00574"></a>00574             <span class="keywordflow">if</span> item.get(<span class="stringliteral">'function'</span>) == <span class="stringliteral">'quiver3'</span>:
<a name="l00575"></a>00575                 z = z/dar[2]
<a name="l00576"></a>00576             <span class="keywordflow">if</span> len(shape(u)) == 2:
<a name="l00577"></a>00577                 nx, ny = shape(u)
<a name="l00578"></a>00578                 <span class="keywordflow">if</span> len(x) == nx:
<a name="l00579"></a>00579                     x = ravel(x[:,NewAxis]*ones((1,ny)))
<a name="l00580"></a>00580                 <span class="keywordflow">if</span> len(y) == ny:
<a name="l00581"></a>00581                     y = ravel(y[NewAxis,:]*ones((nx,1)))
<a name="l00582"></a>00582             u = ravel(u)
<a name="l00583"></a>00583             vectors = vtk.vtkFloatArray()
<a name="l00584"></a>00584             vectors.SetNumberOfTuples(no_points)
<a name="l00585"></a>00585             vectors.SetNumberOfComponents(3)
<a name="l00586"></a>00586             vectors.SetNumberOfValues(3*no_points)
<a name="l00587"></a>00587             <span class="keyword">assert</span> shape(x)==shape(y)==shape(z)==shape(u)==shape(v)==shape(w),\
<a name="l00588"></a>00588                    <span class="stringliteral">"matrix dimensions must agree"</span>
<a name="l00589"></a>00589             <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(no_points):
<a name="l00590"></a>00590                 points.SetPoint(i, x[i], y[i], z[i])
<a name="l00591"></a>00591                 vectors.SetTuple3(i, u[i], v[i], w[i])
<a name="l00592"></a>00592             points.Modified()
<a name="l00593"></a>00593             sgrid.SetPoints(points)
<a name="l00594"></a>00594             sgrid.GetPointData().SetVectors(vectors)
<a name="l00595"></a>00595         <span class="keywordflow">else</span>:
<a name="l00596"></a>00596             values = asarray(item.get(<span class="stringliteral">'zdata'</span>))
<a name="l00597"></a>00597             <span class="keywordflow">if</span> heights:
<a name="l00598"></a>00598                 z = values/dar[2]
<a name="l00599"></a>00599             <span class="keywordflow">elif</span> bottom:
<a name="l00600"></a>00600                 z = zeros(values.shape, dtype=values.dtype) + \
<a name="l00601"></a>00601                     self._axis._vtk_scaled_bounds[4]
<a name="l00602"></a>00602             <span class="keywordflow">else</span>:
<a name="l00603"></a>00603                 z = zeros(values.shape, dtype=values.dtype)
<a name="l00604"></a>00604             <span class="keywordflow">try</span>:
<a name="l00605"></a>00605                 cdata = asarray(item.get(<span class="stringliteral">'cdata'</span>))
<a name="l00606"></a>00606             <span class="keywordflow">except</span> KeyError:
<a name="l00607"></a>00607                 <span class="keywordflow">pass</span>
<a name="l00608"></a>00608             <span class="keywordflow">else</span>:
<a name="l00609"></a>00609                 <span class="keywordflow">if</span> cdata <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> cdata.shape == values.shape:
<a name="l00610"></a>00610                     values = cdata
<a name="l00611"></a>00611             scalars = vtk.vtkFloatArray()
<a name="l00612"></a>00612             scalars.SetNumberOfTuples(no_points)
<a name="l00613"></a>00613             scalars.SetNumberOfComponents(1)
<a name="l00614"></a>00614             nx, ny = shape(values)
<a name="l00615"></a>00615             <span class="keywordflow">if</span> shape(x) == (nx,) <span class="keywordflow">and</span> shape(y) == (ny,):
<a name="l00616"></a>00616                 x = x[:,NewAxis]
<a name="l00617"></a>00617                 y = y[NewAxis,:]
<a name="l00618"></a>00618             <span class="keywordflow">if</span> shape(x) == (nx,1) <span class="keywordflow">and</span> shape(y) == (1,ny):
<a name="l00619"></a>00619                 x = x*ones((1,ny))
<a name="l00620"></a>00620                 y = y*ones((nx,1))
<a name="l00621"></a>00621             <span class="keyword">assert</span> shape(x) == shape(y) == shape(z), \
<a name="l00622"></a>00622                    <span class="stringliteral">"array dimensions must agree"</span>
<a name="l00623"></a>00623             ind = 0
<a name="l00624"></a>00624             <span class="keywordflow">for</span> j <span class="keywordflow">in</span> range(ny):
<a name="l00625"></a>00625                 <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(nx):
<a name="l00626"></a>00626                     points.SetPoint(ind, x[i,j], y[i,j], z[i,j])
<a name="l00627"></a>00627                     scalars.SetValue(ind, values[i,j])
<a name="l00628"></a>00628                     ind += 1
<a name="l00629"></a>00629             points.Modified()
<a name="l00630"></a>00630             sgrid.SetPoints(points)
<a name="l00631"></a>00631             sgrid.GetPointData().SetScalars(scalars)
<a name="l00632"></a>00632 
<a name="l00633"></a>00633         sgrid.Update()
<a name="l00634"></a>00634         <span class="keywordflow">return</span> sgrid
<a name="l00635"></a>00635 
<a name="l00636"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#0dd2f21d2106bcc9c0c1af99f49d4b99">00636</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#0dd2f21d2106bcc9c0c1af99f49d4b99">_get_3d_structured_grid</a>(self, item, vectors=False):
<a name="l00637"></a>00637         dar = self._axis.get(<span class="stringliteral">'daspect'</span>)
<a name="l00638"></a>00638         x = asarray(item.get(<span class="stringliteral">'xdata'</span>))/dar[0]
<a name="l00639"></a>00639         y = asarray(item.get(<span class="stringliteral">'ydata'</span>))/dar[1]
<a name="l00640"></a>00640         z = asarray(item.get(<span class="stringliteral">'zdata'</span>))/dar[2]
<a name="l00641"></a>00641         sgrid = vtk.vtkStructuredGrid()
<a name="l00642"></a>00642         sgrid.SetDimensions(item.get(<span class="stringliteral">'dims'</span>))
<a name="l00643"></a>00643         no_points = item.get(<span class="stringliteral">'numberofpoints'</span>)
<a name="l00644"></a>00644         points = vtk.vtkPoints()
<a name="l00645"></a>00645         points.SetNumberOfPoints(no_points)
<a name="l00646"></a>00646         <span class="keywordflow">if</span> vectors:
<a name="l00647"></a>00647             u = asarray(item.get(<span class="stringliteral">'udata'</span>))
<a name="l00648"></a>00648             v = asarray(item.get(<span class="stringliteral">'vdata'</span>))
<a name="l00649"></a>00649             w = asarray(item.get(<span class="stringliteral">'wdata'</span>))
<a name="l00650"></a>00650             nx, ny, nz = shape(u)
<a name="l00651"></a>00651             <span class="keywordflow">if</span> shape(x) == (nx,) <span class="keywordflow">and</span> shape(y) == (ny,):
<a name="l00652"></a>00652                 x = x[:,NewAxis,NewAxis]
<a name="l00653"></a>00653                 y = y[NewAxis,:,NewAxis]
<a name="l00654"></a>00654             <span class="keywordflow">if</span> shape(x) == (nx,1,1) <span class="keywordflow">and</span> shape(y) == (1,ny,1):
<a name="l00655"></a>00655                 x = x*ones((1,ny,nz))
<a name="l00656"></a>00656                 y = y*ones((nx,1,nz))
<a name="l00657"></a>00657             <span class="keywordflow">if</span> shape(z) == (1,1,nz):
<a name="l00658"></a>00658                 z = z*ones((nx,ny,1))
<a name="l00659"></a>00659             <span class="keyword">assert</span> shape(x) == shape(y) == shape(z) == \
<a name="l00660"></a>00660                    shape(u) == shape(v) == shape(w), \
<a name="l00661"></a>00661                    <span class="stringliteral">"array dimensions must agree"</span>
<a name="l00662"></a>00662                 
<a name="l00663"></a>00663             vectors = vtk.vtkFloatArray()
<a name="l00664"></a>00664             vectors.SetNumberOfTuples(no_points)
<a name="l00665"></a>00665             vectors.SetNumberOfComponents(3)
<a name="l00666"></a>00666             vectors.SetNumberOfValues(3*no_points)
<a name="l00667"></a>00667 
<a name="l00668"></a>00668             ind = 0
<a name="l00669"></a>00669             <span class="keywordflow">for</span> k <span class="keywordflow">in</span> range(nz):
<a name="l00670"></a>00670                 <span class="keywordflow">for</span> j <span class="keywordflow">in</span> range(ny):
<a name="l00671"></a>00671                     <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(nx):
<a name="l00672"></a>00672                         points.SetPoint(ind, x[i,j,k], y[i,j,k], z[i,j,k])
<a name="l00673"></a>00673                         vectors.SetTuple3(ind, u[i,j,k], v[i,j,k], w[i,j,k])
<a name="l00674"></a>00674                         ind += 1
<a name="l00675"></a>00675             points.Modified()
<a name="l00676"></a>00676             sgrid.SetPoints(points)
<a name="l00677"></a>00677             sgrid.GetPointData().SetVectors(vectors)
<a name="l00678"></a>00678         <span class="keywordflow">else</span>:
<a name="l00679"></a>00679             scalars = vtk.vtkFloatArray()
<a name="l00680"></a>00680             scalars.SetNumberOfTuples(no_points)
<a name="l00681"></a>00681             scalars.SetNumberOfComponents(1)
<a name="l00682"></a>00682             
<a name="l00683"></a>00683             v = asarray(item.get(<span class="stringliteral">'vdata'</span>))
<a name="l00684"></a>00684             <span class="comment"># TODO: what about pseudocolor data?</span>
<a name="l00685"></a>00685             <span class="comment">#cdata = ravel(item.get('cdata'))</span>
<a name="l00686"></a>00686             <span class="comment">#if cdata is not None:</span>
<a name="l00687"></a>00687             <span class="comment">#    v = cdata</span>
<a name="l00688"></a>00688             nx, ny, nz = shape(v)
<a name="l00689"></a>00689             <span class="keywordflow">if</span> shape(x) == (nx,) <span class="keywordflow">and</span> shape(y) == (ny,) <span class="keywordflow">and</span> shape(z) == (nz,):
<a name="l00690"></a>00690                 x = x[:,NewAxis,NewAxis]
<a name="l00691"></a>00691                 y = y[NewAxis,:,NewAxis]
<a name="l00692"></a>00692                 z = z[NewAxis,NewAxis,:]
<a name="l00693"></a>00693             <span class="keywordflow">if</span> shape(x) == (nx,1,1) <span class="keywordflow">and</span> \
<a name="l00694"></a>00694                    shape(y) == (1,ny,1) <span class="keywordflow">and</span> shape(z) == (1,1,nz):
<a name="l00695"></a>00695                 x = x*ones((1,ny,nz))
<a name="l00696"></a>00696                 y = y*ones((nx,1,nz))
<a name="l00697"></a>00697                 z = z*ones((nx,ny,1))
<a name="l00698"></a>00698             ind = 0
<a name="l00699"></a>00699             <span class="keywordflow">for</span> k <span class="keywordflow">in</span> range(nz):
<a name="l00700"></a>00700                 <span class="keywordflow">for</span> j <span class="keywordflow">in</span> range(ny):
<a name="l00701"></a>00701                     <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(nx):
<a name="l00702"></a>00702                         points.SetPoint(ind, x[i,j,k], y[i,j,k], z[i,j,k])
<a name="l00703"></a>00703                         scalars.SetValue(ind, v[i,j,k])
<a name="l00704"></a>00704                         ind += 1
<a name="l00705"></a>00705             points.Modified()
<a name="l00706"></a>00706             sgrid.SetPoints(points)
<a name="l00707"></a>00707             sgrid.GetPointData().SetScalars(scalars)
<a name="l00708"></a>00708             
<a name="l00709"></a>00709         sgrid.Update()
<a name="l00710"></a>00710         <span class="keywordflow">return</span> sgrid
<a name="l00711"></a>00711 
<a name="l00712"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#f494dd9e0bc0d3ba399c0c86e0838805">00712</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#f494dd9e0bc0d3ba399c0c86e0838805">_add_surface</a>(self, item, sgrid):
<a name="l00713"></a>00713         plane = vtk.vtkStructuredGridGeometryFilter()
<a name="l00714"></a>00714         plane.SetInput(sgrid)
<a name="l00715"></a>00715         plane.Update()
<a name="l00716"></a>00716         data = self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#fe179a08cd689957492209082af686a7">_cut_data</a>_cut_data(plane)
<a name="l00717"></a>00717         normals = vtk.vtkPolyDataNormals()
<a name="l00718"></a>00718         normals.SetInput(data.GetOutput())
<a name="l00719"></a>00719         normals.SetFeatureAngle(45)
<a name="l00720"></a>00720         normals.Update()
<a name="l00721"></a>00721         mapper = vtk.vtkDataSetMapper()
<a name="l00722"></a>00722         mapper.SetInput(normals.GetOutput())
<a name="l00723"></a>00723         mapper.SetLookupTable(self._axis._vtk_colormap)
<a name="l00724"></a>00724         caxis = self._axis.get(<span class="stringliteral">'caxis'</span>)
<a name="l00725"></a>00725         <span class="keywordflow">if</span> <span class="keywordtype">None</span> <span class="keywordflow">in</span> caxis:
<a name="l00726"></a>00726             caxis = data.GetOutput().GetScalarRange()
<a name="l00727"></a>00727         mapper.SetScalarRange(caxis)
<a name="l00728"></a>00728         mapper.Update()
<a name="l00729"></a>00729         actor = vtk.vtkActor()
<a name="l00730"></a>00730         actor.SetMapper(mapper)
<a name="l00731"></a>00731         <span class="keywordflow">if</span> item.get(<span class="stringliteral">'wireframe'</span>):
<a name="l00732"></a>00732             actor.GetProperty().SetRepresentationToWireframe()
<a name="l00733"></a>00733         <span class="keywordflow">else</span>:
<a name="l00734"></a>00734             self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#e8f0b8d199ab9da7757ba2d087017a6a">_set_shading</a>_set_shading(item, data, actor)
<a name="l00735"></a>00735         self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#14fe82f5d7a1d12266a9cef33ce32bfe">_set_actor_properties</a>_set_actor_properties(item, actor)
<a name="l00736"></a>00736         self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#3d3774b7051424035faa15b4fb668d3d">_add_legend</a>_add_legend(item, normals.GetOutput())
<a name="l00737"></a>00737         self._axis._renderer.AddActor(actor)
<a name="l00738"></a>00738         self._axis._vtk_apd.AddInput(normals.GetOutput())
<a name="l00739"></a>00739         
<a name="l00740"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#d9b63114778e577671a97a7f9165fefc">00740</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#d9b63114778e577671a97a7f9165fefc">_add_contours</a>(self, item, sgrid):
<a name="l00741"></a>00741         plane = vtk.vtkStructuredGridGeometryFilter()
<a name="l00742"></a>00742         plane.SetInput(sgrid)
<a name="l00743"></a>00743         plane.Update()
<a name="l00744"></a>00744         data = self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#fe179a08cd689957492209082af686a7">_cut_data</a>_cut_data(plane)
<a name="l00745"></a>00745         filled = item.get(<span class="stringliteral">'filled'</span>)
<a name="l00746"></a>00746         <span class="keywordflow">if</span> filled:
<a name="l00747"></a>00747             iso = vtk.vtkBandedPolyDataContourFilter()
<a name="l00748"></a>00748             iso.SetScalarModeToValue()
<a name="l00749"></a>00749             iso.GenerateContourEdgesOn()
<a name="l00750"></a>00750         <span class="keywordflow">else</span>:
<a name="l00751"></a>00751             iso = vtk.vtkContourFilter()
<a name="l00752"></a>00752         iso.SetInput(data.GetOutput())
<a name="l00753"></a>00753         clevels = item.get(<span class="stringliteral">'clevels'</span>)
<a name="l00754"></a>00754         cvector = item.get(<span class="stringliteral">'cvector'</span>)
<a name="l00755"></a>00755         <span class="keywordflow">if</span> cvector <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:
<a name="l00756"></a>00756             <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(clevels):
<a name="l00757"></a>00757                 iso.SetValue(i, cvector[i])
<a name="l00758"></a>00758         <span class="keywordflow">else</span>:
<a name="l00759"></a>00759             zmin, zmax = data.GetOutput().GetScalarRange()
<a name="l00760"></a>00760             iso.SetNumberOfContours(clevels)
<a name="l00761"></a>00761             iso.GenerateValues(clevels, zmin, zmax)
<a name="l00762"></a>00762         iso.Update()
<a name="l00763"></a>00763         isoMapper = vtk.vtkPolyDataMapper()
<a name="l00764"></a>00764         isoMapper.SetInput(iso.GetOutput())
<a name="l00765"></a>00765         isoMapper.SetLookupTable(self._axis._vtk_colormap)
<a name="l00766"></a>00766         caxis = self._axis.get(<span class="stringliteral">'caxis'</span>)
<a name="l00767"></a>00767         <span class="keywordflow">if</span> <span class="keywordtype">None</span> <span class="keywordflow">in</span> caxis:
<a name="l00768"></a>00768             caxis = data.GetOutput().GetScalarRange()
<a name="l00769"></a>00769         isoMapper.SetScalarRange(caxis)
<a name="l00770"></a>00770         <span class="keywordflow">if</span> item.get(<span class="stringliteral">'linecolor'</span>): <span class="comment"># linecolor is defined:</span>
<a name="l00771"></a>00771             isoMapper.ScalarVisibilityOff()
<a name="l00772"></a>00772         isoMapper.Update()
<a name="l00773"></a>00773         isoActor = vtk.vtkActor()
<a name="l00774"></a>00774         isoActor.SetMapper(isoMapper)
<a name="l00775"></a>00775         self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#14fe82f5d7a1d12266a9cef33ce32bfe">_set_actor_properties</a>_set_actor_properties(item, isoActor)
<a name="l00776"></a>00776         self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#3d3774b7051424035faa15b4fb668d3d">_add_legend</a>_add_legend(item, iso.GetOutput())
<a name="l00777"></a>00777         self._axis._renderer.AddActor(isoActor)
<a name="l00778"></a>00778         self._axis._vtk_apd.AddInput(data.GetOutput())
<a name="l00779"></a>00779 
<a name="l00780"></a>00780         <span class="keywordflow">if</span> filled: <span class="comment"># create contour edges:</span>
<a name="l00781"></a>00781             edgeMapper = vtk.vtkPolyDataMapper()
<a name="l00782"></a>00782             edgeMapper.SetInput(iso.GetContourEdgesOutput())
<a name="l00783"></a>00783             edgeMapper.SetResolveCoincidentTopologyToPolygonOffset()
<a name="l00784"></a>00784             edgeActor = vtk.vtkActor()
<a name="l00785"></a>00785             edgeActor.SetMapper(edgeMapper)
<a name="l00786"></a>00786             edgeActor.GetProperty().SetColor(0, 0, 0)
<a name="l00787"></a>00787             self._axis._renderer.AddActor(edgeActor)
<a name="l00788"></a>00788 
<a name="l00789"></a>00789         <span class="keywordflow">if</span> item.get(<span class="stringliteral">'clabels'</span>):
<a name="l00790"></a>00790             <span class="comment"># subsample the points and label them:</span>
<a name="l00791"></a>00791             mask = vtk.vtkMaskPoints()
<a name="l00792"></a>00792             mask.SetInput(iso.GetOutput())
<a name="l00793"></a>00793             mask.SetOnRatio(data.GetOutput().GetNumberOfPoints()/50)
<a name="l00794"></a>00794             mask.SetMaximumNumberOfPoints(50)
<a name="l00795"></a>00795             mask.RandomModeOn()
<a name="l00796"></a>00796 
<a name="l00797"></a>00797             <span class="comment"># Create labels for points - only show visible points</span>
<a name="l00798"></a>00798             visPts = vtk.vtkSelectVisiblePoints()
<a name="l00799"></a>00799             visPts.SetInput(mask.GetOutput())
<a name="l00800"></a>00800             visPts.SetRenderer(self._axis._renderer)
<a name="l00801"></a>00801             ldm = vtk.vtkLabeledDataMapper()
<a name="l00802"></a>00802             ldm.SetInput(mask.GetOutput())
<a name="l00803"></a>00803             ldm.SetLabelFormat(<span class="stringliteral">"%.1g"</span>)
<a name="l00804"></a>00804             ldm.SetLabelModeToLabelScalars()
<a name="l00805"></a>00805             tprop = ldm.GetLabelTextProperty()
<a name="l00806"></a>00806             tprop.SetFontFamilyToArial()
<a name="l00807"></a>00807             tprop.SetFontSize(10)
<a name="l00808"></a>00808             tprop.SetColor(0,0,0)
<a name="l00809"></a>00809             tprop.ShadowOff()
<a name="l00810"></a>00810             tprop.BoldOff()
<a name="l00811"></a>00811             contourLabels = vtk.vtkActor2D()
<a name="l00812"></a>00812             contourLabels.SetMapper(ldm)
<a name="l00813"></a>00813             self._axis._renderer.AddActor(contourLabels)
<a name="l00814"></a>00814 
<a name="l00815"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#4f23f73c87fd9b2af27035944a3ea69e">00815</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#4f23f73c87fd9b2af27035944a3ea69e">_add_velocity_vectors</a>(self, item, sgrid):
<a name="l00816"></a>00816         marker, rotation = self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#8d9898b1f1e68ce60c45b89f6ac83322">_arrow_types</a>_arrow_types[item.get(<span class="stringliteral">'linemarker'</span>)]
<a name="l00817"></a>00817         arrow = vtk.vtkGlyphSource2D()
<a name="l00818"></a>00818         arrow.SetGlyphType(marker)
<a name="l00819"></a>00819         arrow.SetFilled(item.get(<span class="stringliteral">'filledarrows'</span>))
<a name="l00820"></a>00820         arrow.SetRotationAngle(rotation)
<a name="l00821"></a>00821         <span class="keywordflow">if</span> arrow.GetGlyphType() != 9: <span class="comment"># not an arrow</span>
<a name="l00822"></a>00822             arrow.DashOn()
<a name="l00823"></a>00823             arrow.SetCenter(.75,0,0)
<a name="l00824"></a>00824         <span class="keywordflow">else</span>:
<a name="l00825"></a>00825             arrow.SetCenter(.5,0,0)        
<a name="l00826"></a>00826         arrow.SetColor(self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#aa21ce1c55d4f085fa7333368c0dabfd">_colors</a>_colors[item.get(<span class="stringliteral">'linecolor'</span>)])
<a name="l00827"></a>00827 
<a name="l00828"></a>00828         plane = vtk.vtkStructuredGridGeometryFilter()
<a name="l00829"></a>00829         plane.SetInput(sgrid)
<a name="l00830"></a>00830         plane.Update()
<a name="l00831"></a>00831         data = self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#fe179a08cd689957492209082af686a7">_cut_data</a>_cut_data(plane)
<a name="l00832"></a>00832         glyph = vtk.vtkGlyph3D()
<a name="l00833"></a>00833         glyph.SetInput(data.GetOutput()) 
<a name="l00834"></a>00834         glyph.SetSource(arrow.GetOutput())
<a name="l00835"></a>00835         glyph.SetColorModeToColorByVector()
<a name="l00836"></a>00836         glyph.SetRange(data.GetOutput().GetScalarRange())
<a name="l00837"></a>00837         glyph.ScalingOn()
<a name="l00838"></a>00838         glyph.SetScaleModeToScaleByVector()
<a name="l00839"></a>00839         glyph.OrientOn()
<a name="l00840"></a>00840         glyph.SetVectorModeToUseVector()
<a name="l00841"></a>00841         glyph.Update()
<a name="l00842"></a>00842         mapper = vtk.vtkPolyDataMapper()
<a name="l00843"></a>00843         mapper.SetInput(glyph.GetOutput())
<a name="l00844"></a>00844         <span class="comment">#vr = data.GetOutput().GetPointData().GetVectors().GetRange()</span>
<a name="l00845"></a>00845         <span class="comment">#mapper.SetScalarRange(vr)</span>
<a name="l00846"></a>00846         mapper.ScalarVisibilityOff()
<a name="l00847"></a>00847         mapper.Update()
<a name="l00848"></a>00848         actor = vtk.vtkActor()
<a name="l00849"></a>00849         actor.SetMapper(mapper)
<a name="l00850"></a>00850         self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#14fe82f5d7a1d12266a9cef33ce32bfe">_set_actor_properties</a>_set_actor_properties(item, actor)
<a name="l00851"></a>00851         self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#3d3774b7051424035faa15b4fb668d3d">_add_legend</a>_add_legend(item, arrow.GetOutput())
<a name="l00852"></a>00852         self._axis._renderer.AddActor(actor)
<a name="l00853"></a>00853         self._axis._vtk_apd.AddInput(glyph.GetOutput())
<a name="l00854"></a>00854 
<a name="l00855"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#9ce4a2eb0cc8d768b80d779a41c3ee91">00855</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#9ce4a2eb0cc8d768b80d779a41c3ee91">_add_streams</a>(self, item, sgrid):
<a name="l00856"></a>00856         length = sgrid.GetLength()
<a name="l00857"></a>00857         max_velocity = sgrid.GetPointData().GetVectors().GetMaxNorm()
<a name="l00858"></a>00858         max_time = 35.0*length/max_velocity
<a name="l00859"></a>00859         
<a name="l00860"></a>00860         n = item.get(<span class="stringliteral">'numberofstreams'</span>)
<a name="l00861"></a>00861         sx = ravel(item.get(<span class="stringliteral">'startx'</span>))
<a name="l00862"></a>00862         sy = ravel(item.get(<span class="stringliteral">'starty'</span>))
<a name="l00863"></a>00863         sz = ravel(item.get(<span class="stringliteral">'startz'</span>))
<a name="l00864"></a>00864         dar = self._axis.get(<span class="stringliteral">'daspect'</span>)
<a name="l00865"></a>00865         <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(n):
<a name="l00866"></a>00866             integ = vtk.vtkRungeKutta2() <span class="comment"># or 4?</span>
<a name="l00867"></a>00867             stream = vtk.vtkStreamLine()
<a name="l00868"></a>00868             stream.SetInput(sgrid)
<a name="l00869"></a>00869             stream.SetStepLength(item.get(<span class="stringliteral">'stepsize'</span>))
<a name="l00870"></a>00870             <span class="comment">#stream.SetIntegrationStepLength(item.get('stepsize'))</span>
<a name="l00871"></a>00871             <span class="comment">#stream.SetIntegrationDirectionToIntegrateBothDirections()</span>
<a name="l00872"></a>00872             stream.SetIntegrationDirectionToForward()
<a name="l00873"></a>00873             <span class="comment">#stream.SetMaximumPropagationTime(max_time)</span>
<a name="l00874"></a>00874             <span class="comment">#stream.SetMaximumPropagationTime(200)</span>
<a name="l00875"></a>00875             stream.SpeedScalarsOn()
<a name="l00876"></a>00876             <span class="comment">#stream.VorticityOn()</span>
<a name="l00877"></a>00877             stream.SetStartPosition(sx[i]/dar[0], sy[i]/dar[1], sz[i]/dar[2])
<a name="l00878"></a>00878             stream.SetIntegrator(integ)
<a name="l00879"></a>00879             stream.Update()
<a name="l00880"></a>00880             data = self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#fe179a08cd689957492209082af686a7">_cut_data</a>_cut_data(stream)
<a name="l00881"></a>00881             <span class="keywordflow">if</span> item.get(<span class="stringliteral">'ribbons'</span>):
<a name="l00882"></a>00882                 streamribbon = vtk.vtkRibbonFilter()
<a name="l00883"></a>00883                 streamribbon.SetInput(data.GetOutput())
<a name="l00884"></a>00884                 streamribbon.VaryWidthOn()
<a name="l00885"></a>00885                 streamribbon.SetWidthFactor(item.get(<span class="stringliteral">'ribbonwidth'</span>))
<a name="l00886"></a>00886                 streamribbon.Update()
<a name="l00887"></a>00887                 output = streamribbon.GetOutput()
<a name="l00888"></a>00888             <span class="keywordflow">elif</span> item.get(<span class="stringliteral">'tubes'</span>):
<a name="l00889"></a>00889                 streamtube = vtk.vtkTubeFilter()
<a name="l00890"></a>00890                 streamtube.SetInput(data.GetOutput())
<a name="l00891"></a>00891                 streamtube.SetRadius(0.02)
<a name="l00892"></a>00892                 streamtube.SetNumberOfSides(item.get(<span class="stringliteral">'n'</span>))
<a name="l00893"></a>00893                 streamtube.SetVaryRadiusToVaryRadiusByVector()
<a name="l00894"></a>00894                 streamtube.Update()
<a name="l00895"></a>00895                 output = streamtube.GetOutput()
<a name="l00896"></a>00896             <span class="keywordflow">else</span>:
<a name="l00897"></a>00897                 output = data.GetOutput()
<a name="l00898"></a>00898             mapper = vtk.vtkPolyDataMapper()
<a name="l00899"></a>00899             mapper.SetInput(output)
<a name="l00900"></a>00900             mapper.SetLookupTable(self._axis._vtk_colormap)
<a name="l00901"></a>00901             caxis = self._axis.get(<span class="stringliteral">'caxis'</span>)
<a name="l00902"></a>00902             <span class="keywordflow">if</span> <span class="keywordtype">None</span> <span class="keywordflow">in</span> caxis:
<a name="l00903"></a>00903                 caxis = output.GetBounds()[4:]
<a name="l00904"></a>00904                 <span class="comment">#caxis = sgrid.GetScalarRange()</span>
<a name="l00905"></a>00905             mapper.SetScalarRange(caxis)
<a name="l00906"></a>00906             mapper.Update()
<a name="l00907"></a>00907             actor = vtk.vtkActor()
<a name="l00908"></a>00908             actor.SetMapper(mapper)
<a name="l00909"></a>00909             <span class="comment">#self._set_shading(item, stream, actor)</span>
<a name="l00910"></a>00910             self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#14fe82f5d7a1d12266a9cef33ce32bfe">_set_actor_properties</a>_set_actor_properties(item, actor)
<a name="l00911"></a>00911             self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#3d3774b7051424035faa15b4fb668d3d">_add_legend</a>_add_legend(item, output)
<a name="l00912"></a>00912             self._axis._renderer.AddActor(actor)
<a name="l00913"></a>00913             self._axis._vtk_apd.AddInput(output)
<a name="l00914"></a>00914             
<a name="l00915"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#dc53c089c6169e46ed0915127a728dcf">00915</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#dc53c089c6169e46ed0915127a728dcf">_add_line</a>(self, item):
<a name="l00916"></a>00916         dar = self._axis.get(<span class="stringliteral">'daspect'</span>)
<a name="l00917"></a>00917         n = item.get(<span class="stringliteral">'numberofpoints'</span>)
<a name="l00918"></a>00918         polydata = vtk.vtkPolyData()
<a name="l00919"></a>00919         polydata.SetLines(vtk.vtkCellArray()) 
<a name="l00920"></a>00920         points = vtk.vtkPoints()
<a name="l00921"></a>00921         <span class="comment">#points.SetNumberOfPoints(n)</span>
<a name="l00922"></a>00922         x = ravel(item.get(<span class="stringliteral">'xdata'</span>))/dar[0]
<a name="l00923"></a>00923         y = ravel(item.get(<span class="stringliteral">'ydata'</span>))/dar[1]
<a name="l00924"></a>00924         z = item.get(<span class="stringliteral">'zdata'</span>)
<a name="l00925"></a>00925         <span class="keywordflow">if</span> z <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:
<a name="l00926"></a>00926             z = ravel(z)/dar[2]
<a name="l00927"></a>00927         <span class="keywordflow">else</span>:
<a name="l00928"></a>00928             z = zeros(n, x.dtype)
<a name="l00929"></a>00929         ids = vtk.vtkIdList()
<a name="l00930"></a>00930         <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(1,n):
<a name="l00931"></a>00931             points.InsertNextPoint(x[i-1], y[i-1], z[i-1])
<a name="l00932"></a>00932             ids.InsertNextId(i-1)
<a name="l00933"></a>00933             ids.InsertNextId(i)
<a name="l00934"></a>00934             polydata.InsertNextCell(3, ids)
<a name="l00935"></a>00935         points.InsertNextPoint(x[n-1], y[n-1], z[n-1]) <span class="comment"># last point</span>
<a name="l00936"></a>00936         polydata.SetPoints(points)
<a name="l00937"></a>00937         polydata.Update()
<a name="l00938"></a>00938         mapper = vtk.vtkPolyDataMapper()
<a name="l00939"></a>00939         mapper.SetInput(polydata)
<a name="l00940"></a>00940         actor = vtk.vtkActor()
<a name="l00941"></a>00941         actor.SetMapper(mapper)
<a name="l00942"></a>00942         self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#14fe82f5d7a1d12266a9cef33ce32bfe">_set_actor_properties</a>_set_actor_properties(item, actor)
<a name="l00943"></a>00943         self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#3d3774b7051424035faa15b4fb668d3d">_add_legend</a>_add_legend(item, polydata)
<a name="l00944"></a>00944         self._axis._renderer.AddActor(actor)
<a name="l00945"></a>00945         self._axis._vtk_apd.AddInput(polydata)
<a name="l00946"></a>00946 
<a name="l00947"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#14fe82f5d7a1d12266a9cef33ce32bfe">00947</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#14fe82f5d7a1d12266a9cef33ce32bfe">_set_actor_properties</a>(self, item, actor):
<a name="l00948"></a>00948         <span class="comment"># set line properties:</span>
<a name="l00949"></a>00949         color = item.get(<span class="stringliteral">'linecolor'</span>)
<a name="l00950"></a>00950         <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(color, (tuple,list)):
<a name="l00951"></a>00951             <span class="keywordflow">try</span>: color = self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#aa21ce1c55d4f085fa7333368c0dabfd">_colors</a>_colors[color]
<a name="l00952"></a>00952             <span class="keywordflow">except</span>: color = (0,0,1) <span class="comment"># use blue as default</span>
<a name="l00953"></a>00953         actor.GetProperty().SetColor(color)
<a name="l00954"></a>00954         <span class="keywordflow">if</span> item.get(<span class="stringliteral">'linetype'</span>) == <span class="stringliteral">'--'</span>:
<a name="l00955"></a>00955             actor.GetProperty().SetLineStipplePattern(65280)
<a name="l00956"></a>00956         <span class="keywordflow">elif</span> item.get(<span class="stringliteral">'linetype'</span>) == <span class="stringliteral">':'</span>:
<a name="l00957"></a>00957             actor.GetProperty().SetLineStipplePattern(0x1111)
<a name="l00958"></a>00958             actor.GetProperty().SetLineStippleRepeatFactor(1)
<a name="l00959"></a>00959         actor.GetProperty().SetPointSize(item.get(<span class="stringliteral">'pointsize'</span>))
<a name="l00960"></a>00960         linewidth = item.get(<span class="stringliteral">'linewidth'</span>)
<a name="l00961"></a>00961         <span class="keywordflow">if</span> linewidth:
<a name="l00962"></a>00962             actor.GetProperty().SetLineWidth(linewidth)
<a name="l00963"></a>00963         
<a name="l00964"></a>00964         <span class="comment"># set material properties:</span>
<a name="l00965"></a>00965         ax = self._axis
<a name="l00966"></a>00966         mat = item.get(<span class="stringliteral">'material'</span>)
<a name="l00967"></a>00967         <span class="keywordflow">if</span> mat.get(<span class="stringliteral">'opacity'</span>) <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:
<a name="l00968"></a>00968             actor.GetProperty().SetOpacity(mat.get(<span class="stringliteral">'opacity'</span>))
<a name="l00969"></a>00969         <span class="keywordflow">if</span> mat.get(<span class="stringliteral">'ambient'</span>) <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:
<a name="l00970"></a>00970             actor.GetProperty().SetAmbient(mat.get(<span class="stringliteral">'ambient'</span>))
<a name="l00971"></a>00971         <span class="keywordflow">if</span> ax.get(<span class="stringliteral">'ambientcolor'</span>) <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:
<a name="l00972"></a>00972             actor.GetProperty().SetAmbientColor(ax.get(<span class="stringliteral">'ambientcolor'</span>))
<a name="l00973"></a>00973         <span class="keywordflow">if</span> mat.get(<span class="stringliteral">'diffuse'</span>) <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:
<a name="l00974"></a>00974             actor.GetProperty().SetDiffuse(mat.get(<span class="stringliteral">'diffuse'</span>))
<a name="l00975"></a>00975         <span class="keywordflow">if</span> ax.get(<span class="stringliteral">'diffusecolor'</span>) <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:
<a name="l00976"></a>00976             actor.GetProperty().SetDiffuseColor(ax.get(<span class="stringliteral">'diffusecolor'</span>))
<a name="l00977"></a>00977         <span class="keywordflow">if</span> mat.get(<span class="stringliteral">'specular'</span>) <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:
<a name="l00978"></a>00978             actor.GetProperty().SetSpecular(mat.get(<span class="stringliteral">'specular'</span>))
<a name="l00979"></a>00979         <span class="keywordflow">if</span> mat.get(<span class="stringliteral">'specularpower'</span>) <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:
<a name="l00980"></a>00980             actor.GetProperty().SetSpecularPower(mat.get(<span class="stringliteral">'specularpower'</span>))
<a name="l00981"></a>00981 
<a name="l00982"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#b74ceb25e484b2f56ef8b89ee07d3896">00982</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#b74ceb25e484b2f56ef8b89ee07d3896">_set_grid</a>(self):
<a name="l00983"></a>00983         <span class="keywordflow">if</span> <span class="keywordflow">not</span> self._axis.get(<span class="stringliteral">'visible'</span>) <span class="keywordflow">or</span> <span class="keywordflow">not</span> self._axis.get(<span class="stringliteral">'grid'</span>):
<a name="l00984"></a>00984             <span class="keywordflow">return</span>
<a name="l00985"></a>00985         b = self._axis._vtk_box_bounds <span class="comment">#self._axis._vtk_scaled_bounds</span>
<a name="l00986"></a>00986         <span class="keywordflow">if</span> self._axis.get(<span class="stringliteral">'camera'</span>).get(<span class="stringliteral">'view'</span>) == 3:
<a name="l00987"></a>00987             origins = [[b[0],b[2],b[4]], [b[0],b[3],b[4]], [b[1],b[2],b[4]]]
<a name="l00988"></a>00988             points1 = [[b[1],b[2],b[4]], [b[0],b[3],b[5]], [b[1],b[2],b[5]]]
<a name="l00989"></a>00989             points2 = [[b[0],b[3],b[4]], [b[1],b[3],b[4]], [b[1],b[3],b[4]]]
<a name="l00990"></a>00990         <span class="keywordflow">else</span>:
<a name="l00991"></a>00991             origins = [[b[0],b[2],0]]
<a name="l00992"></a>00992             points1 = [[b[0],b[3],0]]
<a name="l00993"></a>00993             points2 = [[b[1],b[2],0]]
<a name="l00994"></a>00994         <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(origins)):
<a name="l00995"></a>00995             plane = vtk.vtkPlaneSource()
<a name="l00996"></a>00996             plane.SetResolution(4, 4)
<a name="l00997"></a>00997             plane.SetOrigin(origins[i])
<a name="l00998"></a>00998             plane.SetPoint1(points1[i])
<a name="l00999"></a>00999             plane.SetPoint2(points2[i])
<a name="l01000"></a>01000             plane.Update()
<a name="l01001"></a>01001             mapper = vtk.vtkPolyDataMapper()
<a name="l01002"></a>01002             mapper.SetInput(plane.GetOutput())
<a name="l01003"></a>01003             actor = vtk.vtkActor()
<a name="l01004"></a>01004             actor.SetMapper(mapper)
<a name="l01005"></a>01005             actor.GetProperty().SetColor(0,0,0)
<a name="l01006"></a>01006             actor.GetProperty().SetRepresentationToWireframe()
<a name="l01007"></a>01007             actor.GetProperty().SetLineStipplePattern(0x1111)
<a name="l01008"></a>01008             actor.GetProperty().SetLineStippleRepeatFactor(1)
<a name="l01009"></a>01009             self._axis._renderer.AddActor(actor)
<a name="l01010"></a>01010 
<a name="l01011"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#3e4fb15ab42d486fea7f962dd478ea01">01011</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#3e4fb15ab42d486fea7f962dd478ea01">_create_vtk_data</a>(self):
<a name="l01012"></a>01012         <span class="keywordflow">for</span> item <span class="keywordflow">in</span> self._axis.get(<span class="stringliteral">'plotitems'</span>):
<a name="l01013"></a>01013             func = item.get(<span class="stringliteral">'function'</span>)
<a name="l01014"></a>01014             <span class="keywordflow">if</span> isinstance(item, Line):
<a name="l01015"></a>01015                 self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#dc53c089c6169e46ed0915127a728dcf">_add_line</a>_add_line(item)
<a name="l01016"></a>01016             <span class="keywordflow">elif</span> isinstance(item, Surface):
<a name="l01017"></a>01017                 <span class="keywordflow">if</span> func == <span class="stringliteral">'pcolor'</span>:
<a name="l01018"></a>01018                     sgrid = self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#d5a343d39b9ceac0cef05c829a0298bb">_get_2d_structured_grid</a>_get_2d_structured_grid(item, heights=<span class="keyword">False</span>)
<a name="l01019"></a>01019                 <span class="keywordflow">else</span>:
<a name="l01020"></a>01020                     sgrid = self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#d5a343d39b9ceac0cef05c829a0298bb">_get_2d_structured_grid</a>_get_2d_structured_grid(item)
<a name="l01021"></a>01021                 self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#f494dd9e0bc0d3ba399c0c86e0838805">_add_surface</a>_add_surface(item, sgrid)
<a name="l01022"></a>01022                 citem = item.get(<span class="stringliteral">'contours'</span>)
<a name="l01023"></a>01023                 <span class="keywordflow">if</span> isinstance(citem, Contours):
<a name="l01024"></a>01024                     csgrid = self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#d5a343d39b9ceac0cef05c829a0298bb">_get_2d_structured_grid</a>_get_2d_structured_grid(citem, heights=<span class="keyword">False</span>,
<a name="l01025"></a>01025                                                           bottom=<span class="keyword">True</span>)
<a name="l01026"></a>01026                     self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#d9b63114778e577671a97a7f9165fefc">_add_contours</a>_add_contours(citem, csgrid)
<a name="l01027"></a>01027             <span class="keywordflow">elif</span> isinstance(item, Contours):
<a name="l01028"></a>01028                 <span class="keywordflow">if</span> item.get(<span class="stringliteral">'clocation'</span>) == <span class="stringliteral">'surface'</span>:
<a name="l01029"></a>01029                     sgrid = self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#d5a343d39b9ceac0cef05c829a0298bb">_get_2d_structured_grid</a>_get_2d_structured_grid(item)
<a name="l01030"></a>01030                 <span class="keywordflow">else</span>:
<a name="l01031"></a>01031                     sgrid = self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#d5a343d39b9ceac0cef05c829a0298bb">_get_2d_structured_grid</a>_get_2d_structured_grid(item, heights=<span class="keyword">False</span>)
<a name="l01032"></a>01032                 self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#d9b63114778e577671a97a7f9165fefc">_add_contours</a>_add_contours(item, sgrid)
<a name="l01033"></a>01033             <span class="keywordflow">elif</span> isinstance(item, VelocityVectors):
<a name="l01034"></a>01034                 <span class="keywordflow">if</span> len(item.get(<span class="stringliteral">'udata'</span>).shape) == 3:
<a name="l01035"></a>01035                     sgrid = self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#0dd2f21d2106bcc9c0c1af99f49d4b99">_get_3d_structured_grid</a>_get_3d_structured_grid(item, vectors=<span class="keyword">True</span>)
<a name="l01036"></a>01036                 <span class="keywordflow">else</span>:
<a name="l01037"></a>01037                     sgrid = self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#d5a343d39b9ceac0cef05c829a0298bb">_get_2d_structured_grid</a>_get_2d_structured_grid(item, vectors=<span class="keyword">True</span>)
<a name="l01038"></a>01038                 self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#4f23f73c87fd9b2af27035944a3ea69e">_add_velocity_vectors</a>_add_velocity_vectors(item, sgrid)
<a name="l01039"></a>01039             <span class="keywordflow">elif</span> isinstance(item, Streams):
<a name="l01040"></a>01040                 <span class="keywordflow">if</span> len(item.get(<span class="stringliteral">'udata'</span>).shape) == 3: 
<a name="l01041"></a>01041                     sgrid = self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#0dd2f21d2106bcc9c0c1af99f49d4b99">_get_3d_structured_grid</a>_get_3d_structured_grid(item, vectors=<span class="keyword">True</span>)
<a name="l01042"></a>01042                 <span class="keywordflow">else</span>:
<a name="l01043"></a>01043                     sgrid = self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#d5a343d39b9ceac0cef05c829a0298bb">_get_2d_structured_grid</a>_get_2d_structured_grid(item, vectors=<span class="keyword">True</span>)
<a name="l01044"></a>01044                 self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#9ce4a2eb0cc8d768b80d779a41c3ee91">_add_streams</a>_add_streams(item, sgrid)
<a name="l01045"></a>01045             <span class="keywordflow">elif</span> isinstance(item, Volume):
<a name="l01046"></a>01046                 sgrid = self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#0dd2f21d2106bcc9c0c1af99f49d4b99">_get_3d_structured_grid</a>_get_3d_structured_grid(item)
<a name="l01047"></a>01047                 contours = func == <span class="stringliteral">'contourslice'</span>
<a name="l01048"></a>01048                 <span class="keywordflow">if</span> func <span class="keywordflow">in</span> [<span class="stringliteral">'slice_'</span>, <span class="stringliteral">'contourslice'</span>]:
<a name="l01049"></a>01049                     self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#8ff7dfa7a74b145a301fc723b2066ba0">_add_slices</a>_add_slices(item, sgrid, contours=contours)
<a name="l01050"></a>01050                 <span class="keywordflow">elif</span> func == <span class="stringliteral">'isosurface'</span>:
<a name="l01051"></a>01051                     self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#0a254deb062852cd58ea282944c6e092">_add_isosurface</a>_add_isosurface(item, sgrid)
<a name="l01052"></a>01052             <span class="keywordflow">else</span>:
<a name="l01053"></a>01053                 <span class="keywordflow">raise</span> NotImplementedError, <span class="stringliteral">'%s not yet implemented'</span> % item
<a name="l01054"></a>01054 
<a name="l01055"></a>01055             self._axis._vtk_apd.Update()
<a name="l01056"></a>01056 
<a name="l01057"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#3d3774b7051424035faa15b4fb668d3d">01057</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#3d3774b7051424035faa15b4fb668d3d">_add_legend</a>(self, item, polydata):
<a name="l01058"></a>01058         legend = item.get(<span class="stringliteral">'legend'</span>)
<a name="l01059"></a>01059         <span class="keywordflow">if</span> legend:
<a name="l01060"></a>01060             ax = self._axis
<a name="l01061"></a>01061             n = ax._vtk_nolegends
<a name="l01062"></a>01062             ax._vtk_nolegends += 1
<a name="l01063"></a>01063             ax._vtk_legendbox.SetNumberOfEntries(ax._vtk_nolegends)
<a name="l01064"></a>01064             ax._vtk_legendbox.SetEntrySymbol(n, polydata)
<a name="l01065"></a>01065             ax._vtk_legendbox.SetEntryString(n, legend)
<a name="l01066"></a>01066             color = self.<a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#aa21ce1c55d4f085fa7333368c0dabfd">_colors</a>_colors[item.get(<span class="stringliteral">'linecolor'</span>)]
<a name="l01067"></a>01067             ax._vtk_legendbox.SetEntryColor(n, color)<span class="comment">#ax.get('fgcolor'))</span>
<a name="l01068"></a>01068 
<a name="l01069"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#b2ebb5e23e5fe90cb82a68e8e20ba160">01069</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#b2ebb5e23e5fe90cb82a68e8e20ba160">_set_legends</a>(self):
<a name="l01070"></a>01070         ax = self._axis
<a name="l01071"></a>01071         n = ax._vtk_nolegends
<a name="l01072"></a>01072         <span class="keywordflow">if</span> n &gt; 0:
<a name="l01073"></a>01073             ax._vtk_legendbox.SetNumberOfEntries(n)
<a name="l01074"></a>01074             <span class="comment">#ax._vtk_legendbox.ScalarVisibilityOff()</span>
<a name="l01075"></a>01075             <span class="comment">#ax._vtk_legendbox.BorderOff()</span>
<a name="l01076"></a>01076             ax._vtk_legendbox.GetPositionCoordinate().SetValue(0.8, 0.2, 0)
<a name="l01077"></a>01077             ax._vtk_legendbox.GetPosition2Coordinate().SetValue(.2, n*.1, 0)
<a name="l01078"></a>01078             ax._vtk_legendbox.GetProperty().SetColor(ax.get(<span class="stringliteral">'fgcolor'</span>))
<a name="l01079"></a>01079             ax._renderer.AddActor(ax._vtk_legendbox)
<a name="l01080"></a>01080 
<a name="l01081"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#8676c966a6b2b29bed0cae7611a4250e">01081</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#8676c966a6b2b29bed0cae7611a4250e">_set_lights</a>(self):
<a name="l01082"></a>01082         <span class="keywordflow">if</span> <span class="keywordflow">not</span> hasattr(self._axis, <span class="stringliteral">'_vtk_lights'</span>):
<a name="l01083"></a>01083             self._axis._vtk_lights = []
<a name="l01084"></a>01084         <span class="keywordflow">else</span>: <span class="comment"># remove all lights (if any)</span>
<a name="l01085"></a>01085             <span class="keywordflow">for</span> l <span class="keywordflow">in</span> self._axis._vtk_lights:
<a name="l01086"></a>01086                 self._axis._renderer.RemoveLight(l)
<a name="l01087"></a>01087             self._axis._vtk_lights = []
<a name="l01088"></a>01088         <span class="keywordflow">for</span> l <span class="keywordflow">in</span> self._axis.get(<span class="stringliteral">'lights'</span>):
<a name="l01089"></a>01089             light = vtk.vtkLight()
<a name="l01090"></a>01090             light.SetColor(l.get(<span class="stringliteral">'lightcolor'</span>))
<a name="l01091"></a>01091             light.SetFocalPoint(l.get(<span class="stringliteral">'lighttarget'</span>))
<a name="l01092"></a>01092             light.SetPosition(l.get(<span class="stringliteral">'lightpos'</span>))
<a name="l01093"></a>01093             self._axis._renderer.AddLight(light)
<a name="l01094"></a>01094             self._axis._vtk_lights.append(light)
<a name="l01095"></a>01095 
<a name="l01096"></a><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#79385528011bddbc616602f9c9e5d9b0">01096</a>     <span class="keyword">def </span><a class="code" href="classgraphics_1_1vtk___1_1VtkBackend.html#79385528011bddbc616602f9c9e5d9b0">_setup_axis</a>(self):
<a name="l01097"></a>01097         ax = self._axis
<a name="l01098"></a>01098         xmin, xmax = ax.get(<span class="stringliteral">'xmin'</span>), ax.get(<span class="stringliteral">'xmax'</span>)
<a name="l01099"></a>01099         <span class="keywordflow">if</span> <span class="keywordtype">None</span> <span class="keywordflow">in</span> [xmin, xmax]:
<a name="l01100"></a>01100             xmin, xmax = ax.get(<span class="stringliteral">'xlim'</span>)
<a name="l01101"></a>01101         ymin, ymax = ax.get(<span class="stringliteral">'ymin'</span>), ax.get(<span class="stringliteral">'ymax'</span>)
<a name="l01102"></a>01102         <span class="keywordflow">if</span> <span class="keywordtype">None</span> <span class="keywordflow">in</span> [ymin, ymax]:
<a name="l01103"></a>01103             ymin, ymax = ax.get(<span class="stringliteral">'ylim'</span>)
<a name="l01104"></a>01104         zmin, zmax = ax.get(<span class="stringliteral">'zmin'</span>), ax.get(<span class="stringliteral">'zmax'</span>)
<a name="l01105"></a>01105         <span class="keywordflow">if</span> <span class="keywordtype">None</span> <span class="keywordflow">in</span> [zmin, zmax]:
<a name="l01106"></a>01106             zmin, zmax = ax.get(<span class="stringliteral">'zlim'</span>)
<a name="l01107"></a>01107         bnds = [xmin, xmax, ymin, ymax, zmin, zmax]
<a name="l01108"></a>01108         ax._vtk_bounds = bnds[:]
<a name="l01109"></a>01109         <span class="comment"># scale axis:</span>
<a name="l01110"></a>01110         dar = ax.get(<span class="stringliteral">'daspect'</span>)
<a name="l01111"></a>01111         bnds[0] = bnds[0]/dar[0];  bnds[1] = bnds[1]/dar[0]
<a name="l01112"></a>01112         bnds[2] = bnds[2]/dar[1];  bnds[3] = bnds[3]/dar[1]
<a name="l01113"></a>01113         bnds[4] = bnds[4]/dar[2];  bnds[5] = bnds[5]/dar[2]
<a name="l01114"></a>01114         ax._vtk_scaled_bounds = bnds[:]
<a name="l01115"></a>01115 
<a name="l01116"></a>01116 <span class="comment">##         fig = self.gcf()</span>
<a name="l01117"></a>01117 <span class="comment">##         # clean up:</span>
<a name="l01118"></a>01118 <span class="comment">##         if hasattr(ax, '_renderer'):</span>
<a name="l01119"></a>01119 <span class="comment">##             self._g.RemoveRenderer(ax._renderer)</span>
<a name="l01120"></a>01120 <span class="comment">##             if ax._renderer in fig._renderers:</span>
<a name="l01121"></a>01121 <span class="comment">##                 fig._renderers.remove(ax._renderer)</span>
<a name="l01122"></a>01122 <span class="comment">##             del ax._renderer</span>
<a name="l01123"></a>01123         
<a name="l01124"></a>01124 <span class="comment">##         ax._renderer = vtk.vtkRenderer()</span>
<a name="l01125"></a>01125 <span class="comment">##         self._g.AddRenderer(ax._renderer)</span>
<a name="l01126"></a>01126 <span class="comment">##         # add this new renderer to the current figures list of renderers</span>
<a name="l01127"></a>01127 <span class="comment">##         # so we can remove it later (e.g. when using clf()):</span>
<a name="l01128"></a>01128 <span class="comment">##         fig._renderers.append(ax._renderer)</span>
<a name="l01129"></a>01129 
<a name="l01130"></a>01130         <span class="keywordflow">if</span> <span class="keywordflow">not</span> hasattr(ax, <span class="stringliteral">'_renderer'</span>):
<a name="l01131"></a>01131             ax._renderer = vtk.vtkRenderer()
<a name="l01132"></a>01132             self._g.AddRenderer(ax._renderer)
<a name="l01133"></a>01133             <span class="comment"># add this new renderer to the current figures list of renderers</span>
<a name="l01134"></a>01134             <span class="comment"># so we can remove it later (e.g. when using clf()):</span>
<a name="l01135"></a>01135             self.gcf()._renderers.append(ax._renderer)
<a name="l01136"></a>01136             
<a name="l01137"></a>01137         <span class="keywordflow">if</span> hasattr(ax, <span class="stringliteral">'_vtk_legendbox'</span>):
<a name="l01138"></a>01138             ax._renderer.RemoveActor(ax._vtk_legendbox)
<a name="l01139"></a>01139         ax._vtk_legendbox = vtk.vtkLegendBoxActor()
<a name="l01140"></a>01140         ax._vtk_nolegends = 0
<a name="l01141"></a>01141         ax._vtk_legendbox.SetNumberOfEntries(0)
<a name="l01142"></a>01142 
<a name="l01143"></a>01143         <span class="comment">#ax._renderer.TwoSidedLightingOff()</span>
<a name="l01144"></a>01144         ax._renderer.SetBackground(ax.get(<span class="stringliteral">'bgcolor'</span>))
<a name="l01145"></a>01145         viewport = ax.get(<span class="stringliteral">'viewport'</span>)
<a name="l01146"></a>01146         <span class="keywordflow">if</span> <span class="keywordflow">not</span> viewport:
<a name="l01147"></a>01147             viewport = (0,0,1,1)
<a name="l01148"></a>01148         ax._renderer.SetViewport(viewport)
<a name="l01149"></a>01149         ax._renderer.RemoveAllProps() <span class="comment"># clear current scene</span>
<a name="l01150"></a>01150         <span class="comment">#axshape = self.gcf().get('axshape')</span>
<a name="l01151"></a>01151         <span class="comment">#ax._renderer.SetPixelAspect(axshape[1], axshape[0])</span>
<a name="l01152"></a>01152 
<a name="l01153"></a>01153         <span class="keywordflow">if</span> <span class="keywordflow">not</span> hasattr(ax, <span class="stringliteral">'_vtk_apd'</span>):
<a name="l01154"></a>01154             ax._vtk_apd = vtk.vtkAppendPolyData()
<a name="l01155"></a>01155         <span class="keywordflow">else</span>:
<a name="l01156"></a>01156             ax._vtk_apd.RemoveAllInputs()
<a name="l01157"></a>01157 
<a name="l01158"></a><a class="code" href="namespacegraphics_1_1vtk__.html#d5a154cf4da71e8c1b2725a50ad2be40">01158</a>     <span class="keyword">def </span><a class="code" href="namespacegraphics_1_1vtk__.html#d5a154cf4da71e8c1b2725a50ad2be40">_replot</a>(self):
<a name="l01159"></a><a class="code" href="namespacegraphics_1_1vtk__.html#c9ed33d02eb87806486075efdf071d69">01159</a>         self._axis = self.gca() <span class="comment"># shortcut for fast access</span>
<a name="l01160"></a>01160         
<a name="l01161"></a>01161         fig = self.gcf()
<a name="l01162"></a>01162         <span class="keywordflow">if</span> fig.get(<span class="stringliteral">'axshape'</span>) != fig._axshape:
<a name="l01163"></a>01163             <span class="comment"># remove all current renderers:</span>
<a name="l01164"></a>01164             <span class="keywordflow">for</span> ren <span class="keywordflow">in</span> fig._renderers:
<a name="l01165"></a>01165                 self._g.RemoveRenderer(ren)
<a name="l01166"></a>01166             fig._renderers = []
<a name="l01167"></a>01167             fig._axshape = fig.get(<span class="stringliteral">'axshape'</span>)
<a name="l01168"></a>01168             
<a name="l01169"></a>01169         <span class="comment">#if self._master is not None:</span>
<a name="l01170"></a>01170         <span class="comment">#    fig._root.withdraw()</span>
<a name="l01171"></a>01171 
<a name="l01172"></a>01172         <span class="keywordflow">if</span> len(self._axis.get(<span class="stringliteral">'plotitems'</span>)) &gt; 0:
<a name="l01173"></a>01173             self._setup_axis()
<a name="l01174"></a>01174             self._set_lights()
<a name="l01175"></a>01175             self._set_colormap()
<a name="l01176"></a>01176             self._set_caxis()
<a name="l01177"></a>01177             self._create_vtk_data()
<a name="l01178"></a>01178             self._create_labeled_axes()
<a name="l01179"></a>01179             self._set_view()
<a name="l01180"></a>01180             self._set_box_state()
<a name="l01181"></a>01181             self._set_colorbar()
<a name="l01182"></a>01182             self._set_title()
<a name="l01183"></a>01183             self._set_legends()
<a name="l01184"></a>01184             self._set_grid()
<a name="l01185"></a>01185 
<a name="l01186"></a>01186             <span class="comment"># render scene:</span>
<a name="l01187"></a>01187             self._axis._renderer.Render()
<a name="l01188"></a>01188 
<a name="l01189"></a>01189         <span class="keywordflow">if</span> self.get(<span class="stringliteral">'show'</span>) <span class="keywordflow">and</span> hasattr(fig, <span class="stringliteral">'_root'</span>):
<a name="l01190"></a>01190             fig._root.deiconify() <span class="comment"># raise window</span>
<a name="l01191"></a>01191             fig._root.update()
<a name="l01192"></a>01192             
<a name="l01193"></a>01193         <span class="comment"># render complete scene:</span>
<a name="l01194"></a>01194         self._g.Render()
<a name="l01195"></a>01195             
<a name="l01196"></a><a class="code" href="namespacegraphics_1_1vtk__.html#f330ccb696da0a7b6e8900d4a65eb957">01196</a>     <span class="keyword">def </span><a class="code" href="namespacegraphics_1_1vtk__.html#f330ccb696da0a7b6e8900d4a65eb957">figure</a>(self, *args, **kwargs):
<a name="l01197"></a>01197         <span class="stringliteral">"""Extension of BaseClass.figure"""</span>
<a name="l01198"></a>01198         BaseClass.figure(self, *args, **kwargs) 
<a name="l01199"></a>01199         fig = self.gcf()
<a name="l01200"></a>01200 
<a name="l01201"></a>01201         <span class="keywordflow">try</span>:
<a name="l01202"></a>01202             fig._g
<a name="l01203"></a>01203         <span class="keywordflow">except</span>:
<a name="l01204"></a>01204             <span class="comment"># get the parent's render window if it exists</span>
<a name="l01205"></a>01205             <span class="keywordflow">try</span>:
<a name="l01206"></a>01206                 fig._g = self.parent.renwin
<a name="l01207"></a>01207             <span class="keywordflow">except</span> :
<a name="l01208"></a>01208                 <span class="comment">#otherwise create your own</span>
<a name="l01209"></a>01209                 <span class="comment">#fig._g = self._create_wx_gui()</span>
<a name="l01210"></a>01210                 <span class="keywordflow">print</span> <span class="stringliteral">'could not create wx panel'</span>
<a name="l01211"></a>01211                 <span class="keywordflow">try</span>:
<a name="l01212"></a>01212                     fig._g = self._create_Tk_gui()
<a name="l01213"></a>01213                 <span class="keywordflow">except</span> Tkinter.TclError:
<a name="l01214"></a>01214                     <span class="comment"># can't create gui; only offscreen rendering</span>
<a name="l01215"></a>01215                     fig._g = vtk.vtkRenderWindow()
<a name="l01216"></a>01216                     <span class="keywordflow">try</span>: width, height = fig.get(<span class="stringliteral">'size'</span>)
<a name="l01217"></a>01217                     <span class="keywordflow">except</span> TypeError: width, height = (640, 480)
<a name="l01218"></a>01218                     fig._g.SetSize(width, height)
<a name="l01219"></a>01219                     fig._g.OffScreenRenderingOn()
<a name="l01220"></a>01220             fig._renderers = []
<a name="l01221"></a>01221             fig._axshape = fig.get(<span class="stringliteral">'axshape'</span>)
<a name="l01222"></a><a class="code" href="namespacegraphics_1_1vtk__.html#f72ea63e63b5d27c949911b7311891a7">01222</a>         self._g = fig._g <span class="comment"># link for faster accessvtkRenderWindow</span>
<a name="l01223"></a>01223         <span class="comment">#self._g.SetAAFrames(5)</span>
<a name="l01224"></a>01224 
<a name="l01225"></a><a class="code" href="namespacegraphics_1_1vtk__.html#ec05fe7511b583fd8f00b2a61f146b1e">01225</a>     <span class="keyword">def </span><a class="code" href="namespacegraphics_1_1vtk__.html#ec05fe7511b583fd8f00b2a61f146b1e">clf</a>(self):
<a name="l01226"></a>01226         <span class="stringliteral">"""Clear current figure."""</span>
<a name="l01227"></a>01227         fig = self.gcf()
<a name="l01228"></a>01228         <span class="keywordflow">for</span> ren <span class="keywordflow">in</span> fig._renderers:
<a name="l01229"></a>01229             self._g.RemoveRenderer(ren)
<a name="l01230"></a>01230         fig._renderers = []
<a name="l01231"></a>01231         <span class="keywordflow">if</span> self._master <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:
<a name="l01232"></a>01232             fig._root.withdraw() <span class="comment"># hide window</span>
<a name="l01233"></a>01233         del fig._g
<a name="l01234"></a>01234         BaseClass.clf(self)
<a name="l01235"></a>01235 
<a name="l01236"></a><a class="code" href="namespacegraphics_1_1vtk__.html#631ac3f64cb62912d27c708b804a306b">01236</a>     <span class="keyword">def </span><a class="code" href="namespacegraphics_1_1vtk__.html#631ac3f64cb62912d27c708b804a306b">closefig</a>(self, num):
<a name="l01237"></a>01237         <span class="stringliteral">"""Close figure window with number 'num'."""</span>
<a name="l01238"></a>01238         <span class="keywordflow">if</span> num <span class="keywordflow">in</span> self._figs:
<a name="l01239"></a>01239             curfig = self._attrs[<span class="stringliteral">'curfig'</span>]
<a name="l01240"></a>01240             self.figure(num) <span class="comment"># set figure with 'num' as current figure</span>
<a name="l01241"></a>01241             self.clf()
<a name="l01242"></a>01242             del self._figs[num]
<a name="l01243"></a>01243             self.figure(curfig) <span class="comment"># put back the current figure</span>
<a name="l01244"></a>01244         <span class="keywordflow">else</span>:
<a name="l01245"></a>01245             <span class="keywordflow">print</span> <span class="stringliteral">'no such figure with number'</span>, num
<a name="l01246"></a>01246 
<a name="l01247"></a><a class="code" href="namespacegraphics_1_1vtk__.html#41a483b5039a149390f8ed5e496470d6">01247</a>     <span class="keyword">def </span><a class="code" href="namespacegraphics_1_1vtk__.html#41a483b5039a149390f8ed5e496470d6">closefigs</a>(self):
<a name="l01248"></a>01248         <span class="stringliteral">"""Close all figure windows."""</span>
<a name="l01249"></a>01249         keys = self._figs.keys()
<a name="l01250"></a>01250         <span class="keywordflow">for</span> key <span class="keywordflow">in</span> keys:
<a name="l01251"></a>01251             closefig(key)
<a name="l01252"></a>01252         BaseClass.closefigs(self)
<a name="l01253"></a>01253         self.figure(self._attrs[<span class="stringliteral">'curfig'</span>])
<a name="l01254"></a>01254 
<a name="l01255"></a><a class="code" href="namespacegraphics_1_1vtk__.html#e0294b0fd585c5338f36c0fc4f4e3898">01255</a>     <span class="keyword">def </span><a class="code" href="namespacegraphics_1_1vtk__.html#e0294b0fd585c5338f36c0fc4f4e3898">hardcopy</a>(self, filename=None, **kwargs):
<a name="l01256"></a>01256         color = self.get(<span class="stringliteral">'color'</span>)
<a name="l01257"></a>01257 
<a name="l01258"></a>01258         <span class="keywordflow">if</span> filename <span class="keywordflow">is</span> <span class="keywordtype">None</span>:
<a name="l01259"></a>01259             <span class="keywordflow">print</span> <span class="stringliteral">"no filename given, can't save figure"</span>
<a name="l01260"></a>01260             <span class="keywordflow">return</span>
<a name="l01261"></a>01261 
<a name="l01262"></a>01262         quality = 100 <span class="comment"># 0 = low quality, 100 = high quality (only for JPEG)</span>
<a name="l01263"></a>01263         <span class="keywordflow">if</span> <span class="stringliteral">'quality'</span> <span class="keywordflow">in</span> kwargs:
<a name="l01264"></a>01264             quality = int(kwargs[<span class="stringliteral">'quality'</span>])
<a name="l01265"></a>01265         
<a name="l01266"></a>01266         <span class="keywordflow">if</span> <span class="keywordflow">not</span> self.get(<span class="stringliteral">'show'</span>): <span class="comment"># Don't display to screen</span>
<a name="l01267"></a>01267             self._g.OffScreenRenderingOn()
<a name="l01268"></a>01268 
<a name="l01269"></a>01269         self._replot()
<a name="l01270"></a>01270         w2if = vtk.vtkWindowToImageFilter()
<a name="l01271"></a>01271         w2if.SetInput(self._g)
<a name="l01272"></a>01272         <span class="comment"># use extension of the file name to determine which writer to use:</span>
<a name="l01273"></a>01273         ext = os.path.splitext(filename)[1][1:] 
<a name="l01274"></a>01274         <span class="keywordflow">if</span> ext <span class="keywordflow">in</span> self._image_writers.keys():
<a name="l01275"></a>01275             writer = self._image_writers[ext]
<a name="l01276"></a>01276         <span class="keywordflow">else</span>:
<a name="l01277"></a>01277             <span class="keywordflow">print</span> <span class="stringliteral">"File extension '%s' not supported. "</span> \
<a name="l01278"></a>01278                   <span class="stringliteral">"Using PostScript output."</span> % ext
<a name="l01279"></a>01279             writer = vtk.vtkPostScriptWriter()
<a name="l01280"></a>01280         <span class="keywordflow">if</span> hasattr(writer, <span class="stringliteral">'SetQuality'</span>): <span class="comment"># jpeg</span>
<a name="l01281"></a>01281             writer.SetQuality(quality)
<a name="l01282"></a>01282         writer.SetFileName(filename)
<a name="l01283"></a>01283         writer.SetInput(w2if.GetOutput())
<a name="l01284"></a>01284         writer.Write()
<a name="l01285"></a>01285         self._g.OffScreenRenderingOff()
<a name="l01286"></a>01286 
<a name="l01287"></a><a class="code" href="namespacegraphics_1_1vtk__.html#509ce7b734ad97a6eec188510589982b">01287</a>     <span class="keyword">def </span><a class="code" href="namespacegraphics_1_1vtk__.html#509ce7b734ad97a6eec188510589982b">brighten</a>(self, *args):
<a name="l01288"></a>01288         <span class="stringliteral">"""Brighten or darken color map."""</span>
<a name="l01289"></a>01289         nargs = len(args)
<a name="l01290"></a>01290         <span class="keywordflow">if</span> nargs == 2: <span class="comment"># brighten(map,beta)</span>
<a name="l01291"></a>01291             <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(args[0], vtk.vtkLookupTable):
<a name="l01292"></a>01292                 <span class="keywordflow">raise</span> ValueError, <span class="stringliteral">"brighten: map must be %s, not %s"</span> % \
<a name="l01293"></a>01293                       (type(vtk.vtkLookupTable), type(args[0]))
<a name="l01294"></a>01294             lut, beta = args
<a name="l01295"></a>01295         <span class="keywordflow">elif</span> nargs == 1: <span class="comment"># brighten(beta)</span>
<a name="l01296"></a>01296             <span class="keywordflow">if</span> <span class="keywordflow">not</span> hasattr(self._axis, <span class="stringliteral">'_vtk_colormap'</span>):
<a name="l01297"></a>01297                 <span class="keywordflow">print</span> <span class="stringliteral">"brighten: no colormap set."</span>
<a name="l01298"></a>01298                 <span class="keywordflow">return</span>
<a name="l01299"></a>01299             lut = self._axis._vtk_colormap
<a name="l01300"></a>01300             beta = args[0]
<a name="l01301"></a>01301         <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(beta, (float,int)) <span class="keywordflow">or</span> (beta &lt;= -1 <span class="keywordflow">or</span> beta &gt;= 1):
<a name="l01302"></a>01302             <span class="keywordflow">raise</span> ValueError, <span class="stringliteral">"brighten: beta must be between -1 and 1"</span>
<a name="l01303"></a>01303         <span class="comment"># all is OK, change colormap:</span>
<a name="l01304"></a>01304         hue = lut.GetHueRange()
<a name="l01305"></a>01305         val = lut.GetValueRange()
<a name="l01306"></a>01306  
<a name="l01307"></a>01307     <span class="comment"># colormaps</span>
<a name="l01308"></a><a class="code" href="namespacegraphics_1_1vtk__.html#a03e400f7dac8849d4218265db6cfb36">01308</a>     <span class="keyword">def </span><a class="code" href="namespacegraphics_1_1vtk__.html#a03e400f7dac8849d4218265db6cfb36">hsv</a>(self, m=256):
<a name="l01309"></a>01309         lut = vtk.vtkLookupTable()
<a name="l01310"></a>01310         lut.SetHueRange(0.0, 1.0)
<a name="l01311"></a>01311         lut.SetSaturationRange(1.0, 1.0)
<a name="l01312"></a>01312         lut.SetValueRange(1.0, 1.0)
<a name="l01313"></a>01313         lut.SetNumberOfColors(m)
<a name="l01314"></a>01314         lut.Build()
<a name="l01315"></a>01315         <span class="keywordflow">return</span> lut
<a name="l01316"></a>01316 
<a name="l01317"></a><a class="code" href="namespacegraphics_1_1vtk__.html#55d02418054238b6f1c953b0caa90f40">01317</a>     <span class="keyword">def </span><a class="code" href="namespacegraphics_1_1vtk__.html#55d02418054238b6f1c953b0caa90f40">gray</a>(self, m=256):
<a name="l01318"></a>01318         lut = vtk.vtkLookupTable()
<a name="l01319"></a>01319         lut.SetHueRange(0.0, 0.0)
<a name="l01320"></a>01320         lut.SetSaturationRange(0.0, 0.0)
<a name="l01321"></a>01321         lut.SetValueRange(0.0, 1.0)
<a name="l01322"></a>01322         lut.SetNumberOfColors(m)
<a name="l01323"></a>01323         lut.Build()
<a name="l01324"></a>01324         <span class="keywordflow">return</span> lut
<a name="l01325"></a>01325 
<a name="l01326"></a><a class="code" href="namespacegraphics_1_1vtk__.html#17e7df137632b26d2eec64eb1bd0ac74">01326</a>     <span class="keyword">def </span><a class="code" href="namespacegraphics_1_1vtk__.html#17e7df137632b26d2eec64eb1bd0ac74">hot</a>(self, m=256):
<a name="l01327"></a>01327         lut = vtk.vtkLookupTable()
<a name="l01328"></a>01328         inc = 0.01175
<a name="l01329"></a>01329         lut.SetNumberOfColors(256)
<a name="l01330"></a>01330         i = 0
<a name="l01331"></a>01331         r = 0.0; g = 0.0; b = 0.0
<a name="l01332"></a>01332         <span class="keywordflow">while</span> r &lt;= 1.:
<a name="l01333"></a>01333             lut.SetTableValue(i, r, g, b, 1)
<a name="l01334"></a>01334             r += inc;  i += 1
<a name="l01335"></a>01335         r = 1.
<a name="l01336"></a>01336         <span class="keywordflow">while</span> g &lt;= 1.:
<a name="l01337"></a>01337             lut.SetTableValue(i, r, g, b, 1)
<a name="l01338"></a>01338             g += inc;  i += 1
<a name="l01339"></a>01339         g = 1.
<a name="l01340"></a>01340         <span class="keywordflow">while</span> b &lt;= 1:
<a name="l01341"></a>01341             <span class="keywordflow">if</span> i == 256: <span class="keywordflow">break</span>
<a name="l01342"></a>01342             lut.SetTableValue(i, r, g, b, 1)
<a name="l01343"></a>01343             b += inc;  i += 1
<a name="l01344"></a>01344         lut.Build()
<a name="l01345"></a>01345         <span class="keywordflow">return</span> lut
<a name="l01346"></a>01346 
<a name="l01347"></a><a class="code" href="namespacegraphics_1_1vtk__.html#0cbb357b117d658c548e70f80a382004">01347</a>     <span class="keyword">def </span><a class="code" href="namespacegraphics_1_1vtk__.html#0cbb357b117d658c548e70f80a382004">flag</a>(self, m=64):
<a name="l01348"></a>01348         <span class="stringliteral">"""Alternating red, white, blue, and black color map.</span>
<a name="l01349"></a>01349 <span class="stringliteral"></span>
<a name="l01350"></a>01350 <span class="stringliteral">        - flag(m)</span>
<a name="l01351"></a>01351 <span class="stringliteral">          'm' must be a multiple of 4</span>
<a name="l01352"></a>01352 <span class="stringliteral">        """</span>
<a name="l01353"></a>01353         lut = vtk.vtkLookupTable()
<a name="l01354"></a>01354         lut.SetNumberOfColors(m)
<a name="l01355"></a>01355         <span class="comment"># the last parameter alpha is set to 1 by default</span>
<a name="l01356"></a>01356         <span class="comment"># in method declaration</span>
<a name="l01357"></a>01357         <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(0,m,4):
<a name="l01358"></a>01358             lut.SetTableValue(i,1,0,0,1)   <span class="comment"># red</span>
<a name="l01359"></a>01359             lut.SetTableValue(1+i,1,1,1,1) <span class="comment"># white</span>
<a name="l01360"></a>01360             lut.SetTableValue(2+i,0,0,1,1) <span class="comment"># blue</span>
<a name="l01361"></a>01361             lut.SetTableValue(3+i,0,0,0,1) <span class="comment"># black</span>
<a name="l01362"></a>01362         lut.Build()
<a name="l01363"></a>01363         <span class="keywordflow">return</span> lut
<a name="l01364"></a>01364 
<a name="l01365"></a><a class="code" href="namespacegraphics_1_1vtk__.html#702ec5f98a0ecaed552b2797d11ca1a2">01365</a>     <span class="keyword">def </span><a class="code" href="namespacegraphics_1_1vtk__.html#702ec5f98a0ecaed552b2797d11ca1a2">jet</a>(self, m=256):
<a name="l01366"></a>01366         <span class="comment"># blue, cyan, green, yellow, red, black</span>
<a name="l01367"></a>01367         lut = vtk.vtkLookupTable()
<a name="l01368"></a>01368         lut.SetNumberOfColors(m)
<a name="l01369"></a>01369         lut.SetHueRange(0.667,0.0)
<a name="l01370"></a>01370         lut.Build()
<a name="l01371"></a>01371         <span class="keywordflow">return</span> lut
<a name="l01372"></a>01372 
<a name="l01373"></a><a class="code" href="namespacegraphics_1_1vtk__.html#9d2079f95db165ff7b6557a86b4815a2">01373</a>     <span class="keyword">def </span><a class="code" href="namespacegraphics_1_1vtk__.html#9d2079f95db165ff7b6557a86b4815a2">blue_to_yellow</a>(self, m=200):
<a name="l01374"></a>01374         lut = vtk.vtkLookupTable()
<a name="l01375"></a>01375         lut.SetNumberOfColors(m)
<a name="l01376"></a>01376         <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(m):
<a name="l01377"></a>01377             frac = i / float(m / 2.0 - 1.0)
<a name="l01378"></a>01378             <span class="keywordflow">if</span> (frac &lt;= 1):
<a name="l01379"></a>01379                 r = frac
<a name="l01380"></a>01380                 g = r
<a name="l01381"></a>01381                 b = 1
<a name="l01382"></a>01382             <span class="keywordflow">else</span>:
<a name="l01383"></a>01383                 r = 1
<a name="l01384"></a>01384                 g = r
<a name="l01385"></a>01385                 b = 2 - frac
<a name="l01386"></a>01386             <span class="comment"># SetTableValue(indx, red, green, blue, alpha)</span>
<a name="l01387"></a>01387             lut.SetTableValue(i, r, g, b, 1)
<a name="l01388"></a>01388         lut.Build()
<a name="l01389"></a>01389         <span class="keywordflow">return</span> lut
<a name="l01390"></a>01390 
<a name="l01391"></a><a class="code" href="namespacegraphics_1_1vtk__.html#7534a77d9dc418756527081e63d78396">01391</a>     <span class="keyword">def </span><a class="code" href="namespacegraphics_1_1vtk__.html#7534a77d9dc418756527081e63d78396">spring</a>(self, m=256):
<a name="l01392"></a>01392         lut = vtk.vtkLookupTable()
<a name="l01393"></a>01393         lut.SetNumberOfColors(m)
<a name="l01394"></a>01394         lut.SetHueRange(0.0, 0.17)
<a name="l01395"></a>01395         lut.SetSaturationRange(0.5, 1.0) 
<a name="l01396"></a>01396         lut.SetValueRange(1.0, 1.0)
<a name="l01397"></a>01397         lut.Build()
<a name="l01398"></a>01398         <span class="keywordflow">return</span> lut
<a name="l01399"></a>01399 
<a name="l01400"></a><a class="code" href="namespacegraphics_1_1vtk__.html#c822d5efa2d2f6333e29fff0908dbf68">01400</a>     <span class="keyword">def </span><a class="code" href="namespacegraphics_1_1vtk__.html#c822d5efa2d2f6333e29fff0908dbf68">summer</a>(self, m=256):
<a name="l01401"></a>01401         lut = vtk.vtkLookupTable()
<a name="l01402"></a>01402         lut.SetNumberOfColors(m)
<a name="l01403"></a>01403         lut.SetHueRange(0.47, 0.17)
<a name="l01404"></a>01404         lut.SetSaturationRange(1.0, 0.6) 
<a name="l01405"></a>01405         lut.SetValueRange(0.5, 1.0)
<a name="l01406"></a>01406         lut.Build()
<a name="l01407"></a>01407         <span class="keywordflow">return</span> lut
<a name="l01408"></a>01408 
<a name="l01409"></a><a class="code" href="namespacegraphics_1_1vtk__.html#fc7f7a34aa4823f2ba8b95a307b126bb">01409</a>     <span class="keyword">def </span><a class="code" href="namespacegraphics_1_1vtk__.html#fc7f7a34aa4823f2ba8b95a307b126bb">winter</a>(self, m=256):
<a name="l01410"></a>01410         lut = vtk.vtkLookupTable()
<a name="l01411"></a>01411         lut.SetNumberOfColors(m)
<a name="l01412"></a>01412         lut.SetHueRange(0.8, 0.42)
<a name="l01413"></a>01413         lut.SetSaturationRange(1.0, 1.0) 
<a name="l01414"></a>01414         lut.SetValueRange(0.6, 1.0)
<a name="l01415"></a>01415         lut.Build()
<a name="l01416"></a>01416         <span class="keywordflow">return</span> lut
<a name="l01417"></a>01417         
<a name="l01418"></a><a class="code" href="namespacegraphics_1_1vtk__.html#432b36ef05d3b18c0faf373e1419c257">01418</a>     <span class="keyword">def </span><a class="code" href="namespacegraphics_1_1vtk__.html#432b36ef05d3b18c0faf373e1419c257">autumn</a>(self, m=256):
<a name="l01419"></a>01419         lut = vtk.vtkLookupTable()
<a name="l01420"></a>01420         lut.SetNumberOfColors(m)
<a name="l01421"></a>01421         lut.SetHueRange(0.0, 0.15)
<a name="l01422"></a>01422         lut.SetSaturationRange(1.0, 1.0) 
<a name="l01423"></a>01423         lut.SetValueRange(1.0, 1.0)
<a name="l01424"></a>01424         lut.Build()
<a name="l01425"></a>01425         <span class="keywordflow">return</span> lut
<a name="l01426"></a>01426 
<a name="l01427"></a>01427 
<a name="l01428"></a>01428 
<a name="l01429"></a><a class="code" href="namespacegraphics_1_1vtk__.html#a34a77b1a71878ff5829e9d2b13164ca">01429</a> <span class="keyword">def </span><a class="code" href="namespacegraphics_1_1vtk__.html#a34a77b1a71878ff5829e9d2b13164ca">get_backend</a>():
<a name="l01430"></a>01430     <span class="keywordflow">return</span> plt._g
<a name="l01431"></a>01431 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Fri Sep 28 18:29:16 2007 for graphics by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>
